# UMIS RAG Cursor Rules
# 
# ëª©ì : Cursorë§Œìœ¼ë¡œ UMIS ì‚¬ìš© + RAG ê°œë°œ ë³‘í–‰
# ì‚¬ìš©ì: ì½”ë”© ëª» í•˜ëŠ” ì‚¬ìš©ì
# í™˜ê²½: Cursor Composer + Agent ëª¨ë“œ
#
# ========================================

## ì´ˆê¸° ì„¤ì¹˜ ì•ˆë‚´

When user mentions "umis ì„¤ì¹˜" or "ì„¤ì •" or "setup":
  
  Check if .env file exists:
    - If NO:
      1. Create .env from env.template:
         cp env.template .env
      
      2. Guide user:
         "âœ… .env íŒŒì¼ì„ ìƒì„±í–ˆìŠµë‹ˆë‹¤!
         
         ë‹¤ìŒ ë‹¨ê³„:
         1. .env íŒŒì¼ì„ ì—´ì–´ì£¼ì„¸ìš”
         2. OPENAI_API_KEY=your-api-key-here
            â†’ ìì‹ ì˜ OpenAI API í‚¤ë¡œ ë³€ê²½
         
         API í‚¤ ë°›ê¸°:
         https://platform.openai.com/api-keys"
      
      3. After API key added:
         "âœ… API í‚¤ ì„¤ì • ì™„ë£Œ!
         
         ì´ì œ RAG ì¸ë±ìŠ¤ë¥¼ êµ¬ì¶•í•˜ê² ìŠµë‹ˆë‹¤... (1ë¶„)"
         
         python scripts/02_build_index.py --agent explorer
         
         "âœ… ëª¨ë“  ì„¤ì • ì™„ë£Œ!
         
         ì‚¬ìš© ë°©ë²•:
         Cmd+I í•˜ê³ 
         @umis_guidelines.yaml
         '@Steve, ì‹œì¥ ë¶„ì„í•´ì¤˜'
         
         ì¦‰ì‹œ ì‚¬ìš©í•˜ì„¸ìš”!"
    
    - If YES:
      "âœ… ì´ë¯¸ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤!
      
      ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥:
      @umis_guidelines.yaml
      '@Steve, ì‹œì¥ ë¶„ì„í•´ì¤˜'"

## ========================================

## Agent ì´ë¦„ ì»¤ìŠ¤í„°ë§ˆì´ì§•

User can customize agent names in agent_names.yaml:
  - Observer â†’ "Jane", "ê´€ì°°ì", "MarketBot", etc.
  - Explorer â†’ "Alex", "íƒìƒ‰ì", "OpportunityBot", etc.

ì–‘ë°©í–¥ ì‘ë™ (ì…ë ¥ + ì¶œë ¥):
  
  ì…ë ¥ ì¸ì‹:
    User: "@Jane, ì‹œì¥ ë¶„ì„í•´"
    â†’ agent_names.yaml í™•ì¸
    â†’ "Jane" = Observer
    â†’ Observer.analyze() ì‹¤í–‰
  
  ì¶œë ¥ í‘œì‹œ:
    Observer ì‘ì—… ì¤‘...
    â†’ agent_names.yaml í™•ì¸
    â†’ display_name: "Jane"
    â†’ "Janeì´ ì‹œì¥ì„ ê´€ì°°í•©ë‹ˆë‹¤..."

ë§¤í•‘ ê·œì¹™:
  1. agent_names.yaml ìë™ ë¡œë“œ
  2. display_name â†” id ë§¤í•‘ ìƒì„±
     {"Jane": "observer", "Alex": "explorer"}
  3. ì‚¬ìš©ì ì–¸ê¸‰ ì‹œ:
     - "@Jane" ê°ì§€ â†’ observer í˜¸ì¶œ
     - "@Alex" ê°ì§€ â†’ explorer í˜¸ì¶œ
  4. Agent ì¶œë ¥ ì‹œ:
     - observer â†’ "Jane"ìœ¼ë¡œ í‘œì‹œ
     - explorer â†’ "Alex"ë¡œ í‘œì‹œ

Example:
  agent_names.yaml (ìµœì†Œí™” í˜•ì‹):
    observer: Jane
    explorer: Alex
    quantifier: Mike
  
  User: "@Jane, ì‹œì¥ êµ¬ì¡° ë¶„ì„í•´"
  â†’ Observer (ë‚´ë¶€) ì‹¤í–‰
  â†’ "Janeì´ ì‹œì¥ì„ ê´€ì°°í•©ë‹ˆë‹¤..." (ì¶œë ¥)
  
  User: "@Alex, ê¸°íšŒ ì°¾ì•„ë´"
  â†’ Explorer (ë‚´ë¶€) ì‹¤í–‰
  â†’ "Alexê°€ íŒ¨í„´ì„ ê²€ìƒ‰í•©ë‹ˆë‹¤..." (ì¶œë ¥)
  
  ê¸°ë³¸ê°’ (íŒŒì¼ì— ì—†ìœ¼ë©´):
    observer: Albert
    explorer: Steve
    quantifier: Bill
    validator: Rachel
    guardian: Stewart
  
  User: "Observer, ì‹œì¥ ë¶„ì„í•´"  (IDë¡œë„ ì‘ë™!)
  User: "Albert, ì‹œì¥ ë¶„ì„í•´"    (ê¸°ë³¸ ì´ë¦„ìœ¼ë¡œë„ ì‘ë™!)
  User: "Jane, ì‹œì¥ ë¶„ì„í•´"      (ì»¤ìŠ¤í…€ ì´ë¦„ìœ¼ë¡œë„ ì‘ë™!)
  â†’ ëª¨ë‘ ì‘ë™!

## ========================================

## ìë™ RAG ì¬êµ¬ì¶•

When user modifies these YAML files:
  - umis_business_model_patterns.yaml
  - umis_disruption_patterns.yaml
  - umis_ai_guide.yaml

After saving, automatically suggest:
  "RAG ì¸ë±ìŠ¤ë¥¼ ì¬êµ¬ì¶•í• ê¹Œìš”? (2ì´ˆ ì†Œìš”)"
  
If user approves, run:
  ```bash
  cd /Users/kangmin/Documents/AI_dev/umis-main
  source venv/bin/activate
  python scripts/01_convert_yaml.py
  python scripts/02_build_index.py --agent steve
  ```
  
Show result: "âœ… RAG ì—…ë°ì´íŠ¸ ì™„ë£Œ!"

## UMIS ë¶„ì„ ì¤‘ ìë™ RAG í™œìš©

When Explorer needs pattern matching:
  - Detect: "íŒ¨í„´ ë§¤ì¹­ í•„ìš”" or "íŠ¸ë¦¬ê±° ì‹œê·¸ë„ ë°œê²¬"
  - Automatically run:
    ```bash
    python scripts/query_rag.py pattern "{trigger_signals}"
    ```
  - Integrate results into analysis
  - Show: "ğŸ” RAG ê²€ìƒ‰: {pattern_id} ë°œê²¬!"

When Explorer needs case studies:
  - Detect: "ìœ ì‚¬ ì‚¬ë¡€" or "ì„±ê³µ ì‚¬ë¡€"
  - Automatically run:
    ```bash
    python scripts/query_rag.py case "{industry}" --pattern {pattern_id}
    ```
  - Show results in analysis

## ë°ì´í„° ì¶”ê°€ ì›Œí¬í”Œë¡œìš°

When user says:
  - "ë°ì´í„° ì¶”ê°€", "ìˆ˜ì •í•´ì¤˜", "ë„£ì–´ì¤˜"
  
Action:
  1. Open relevant YAML file
  2. Find correct section (use pattern matching)
  3. Show suggested addition with diff
  4. On user approval:
     - Save file
     - Auto rebuild RAG
     - Confirm: "âœ… ì¶”ê°€ ë° RAG ë°˜ì˜ ì™„ë£Œ"

Example:
  User: "ì½”ì›¨ì´ì— í•´ì§€ìœ¨ 3-5% ì¶”ê°€"
  
  AI:
    - Opens: umis_business_model_patterns.yaml
    - Finds: ì½”ì›¨ì´ section (line 348)
    - Suggests:
      ```yaml
      + churn_rate: "3-5%"
      ```
    - Saves + Rebuilds
    - "âœ… ì™„ë£Œ!"

## ë‹¨ì¶• ëª…ë ¹ì–´

User can say:
  - "rag ê²€ìƒ‰ {ì¿¼ë¦¬}" â†’ Run query_rag.py
  - "rag ì¬êµ¬ì¶•" â†’ Full rebuild
  - "rag í†µê³„" â†’ Show stats
  - "rag í…ŒìŠ¤íŠ¸" â†’ Run test search

Auto execute and show results.

## UMIS ë¶„ì„ í”„ë¡œì„¸ìŠ¤ ì§€ì›

When doing UMIS analysis:
  1. Always use @umis_guidelines.yaml
  2. Follow UMIS process (Observer â†’ Explorer â†’ Quantifier â†’ Validator)
  3. Use RAG when needed (automatic)
  4. Save improvements to YAML (automatic)
  
Maintain feedback loop:
  Analysis â†’ Discovery â†’ Addition â†’ Update â†’ Re-analysis

## íŒŒì¼ ê²½ë¡œ ìë™ ì²˜ë¦¬

Project root: /Users/kangmin/Documents/AI_dev/umis-main

When executing commands:
  - Auto cd to project root
  - Auto activate venv
  - Use relative paths from root

## ì—ëŸ¬ ì²˜ë¦¬

If RAG rebuild fails:
  - Show clear error message
  - Suggest: "ì¸ë±ìŠ¤ë¥¼ ì²˜ìŒë¶€í„° ì¬êµ¬ì¶•í• ê¹Œìš”?"
  - Provide recovery command

If YAML syntax error:
  - Point to exact line
  - Suggest fix
  - Validate before rebuild

## ì„±ëŠ¥ ìµœì í™”

- Cache query results (avoid duplicate searches)
- Batch multiple YAML changes (rebuild once)
- Show progress for long operations

## ì‚¬ìš©ì ì¹œí™”ì  ë©”ì‹œì§€

Instead of:
  "Executing python scripts/query_rag.py..."
  
Use:
  "ğŸ” RAGì—ì„œ íŒ¨í„´ ê²€ìƒ‰ ì¤‘..."
  "âœ… subscription_model ë°œê²¬!"
  "ğŸ’¾ YAML ì €ì¥ ë° RAG ì—…ë°ì´íŠ¸ ì¤‘... (2ì´ˆ)"
  "âœ… ì™„ë£Œ! ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤."

## í•œêµ­ì–´ ìš°ì„ 

- ëª¨ë“  ì‘ë‹µ í•œêµ­ì–´
- ê¸°ìˆ  ìš©ì–´ë„ ì‰½ê²Œ ì„¤ëª…
- ì‚¬ìš©ìê°€ ì½”ë”© ëª» í•´ë„ ì´í•´ ê°€ëŠ¥í•˜ê²Œ
