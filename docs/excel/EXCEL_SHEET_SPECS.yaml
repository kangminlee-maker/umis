# Excel 시트 구조 명세
# 각 시트의 예상 구조를 정의하여 자동 검증

market_sizing:
  
  convergence_analysis:
    description: "4가지 Method SAM 수렴 분석"
    
    layout:
      title_row: 1
      header_row: 3
      data_start_row: 4
      
      expected_rows:
        4:
          A: "Method_1_TopDown"
          B: "=SAM"
          C: "=(B4-$B$8)/$B$8*100"
        
        5:
          A: "Method_2_BottomUp"
          B: "=SAM_Method2"
        
        6:
          A: "Method_3_Proxy"
          B: "=SAM_Method3"
        
        7:
          A: "Method_4_CompetitorRevenue"
          B: "=SAM_Method4"
        
        8:
          A: "평균"
          B: "=AVERAGE(B4:B7)"
          type: "핵심 결과"
        
        9:
          A: "표준편차"
          B: "=STDEV(B4:B7)"
          type: "핵심 결과"
        
        10:
          A: "변동계수"
          B: "=B9/B8"  # 표준편차 / 평균
          type: "핵심 결과"
        
        11:
          A: "Max/Min 비율"
          B: "=MAX(B4:B7)/MIN(B4:B7)"
          type: "핵심 결과"
        
        12:
          A: "수렴 여부"
          B: "=IF(B11<=1.3, ✅, ❌)"
          type: "핵심 결과"
  
  summary:
    description: "핵심 지표 요약"
    
    expected_cells:
      B5:
        label_A5: "Total Addressable Market (TAM):"
        formula: "=TAM"
        expected_value: 100_000_000_000
        type: "Named Range 참조"
      
      B6:
        label_A6: "Serviceable Addressable Market (SAM):"
        formula: "=Convergence_Analysis!B8"  # 평균 (Row 8)
        expected_value: 12_062_500_000
        type: "Convergence 평균 참조"
      
      B10:
        label_A10: "Method 1: Top-Down"
        formula: "=SAM"
        reference_base: "B6"  # % 계산 기준
        type: "Method SAM"
      
      B11:
        label_A11: "Method 2: Bottom-Up"
        formula: "=SAM_Method2"
        reference_base: "B6"
      
      C10:
        formula: "=B10/B6*100"  # B6 참조 (B7 아님!)
        type: "% 계산"
      
      C11:
        formula: "=B11/B6*100"
        type: "% 계산"
      
      C12:
        formula: "=B12/B6*100"
        type: "% 계산"
      
      C13:
        formula: "=B13/B6*100"
        type: "% 계산"
      
      B16:
        label_A16: "Max/Min Ratio:"
        formula: "=Convergence_Analysis!B11"  # Row 11 (C19 아님!)
        expected_value: 6.67
      
      B18:
        label_A18: "Standard Deviation:"
        formula: "=Convergence_Analysis!B9"  # Row 9 (C17 아님!)
        type: "표준편차"
      
      B19:
        label_A19: "Coefficient of Variation (CV%):"
        formula: "=Convergence_Analysis!B10"  # Row 10 (C18 아님!)
        type: "변동계수"
      
      B23:
        label_A23: "Best Case (+15%)"
        formula: "=AvgSAM_Best"
        expected_value: 13_871_875_000
      
      B29:
        label_A29: "Total Validation Items:"
        formula: "=Validation_Log!B15"  # B19 아님!
      
      B30:
        label_A30: "Validated:"
        formula: "=Validation_Log!B16"  # B20 아님!
  
  estimation_details:
    description: "추정치 상세 문서화"
    
    expected_structure:
      columns:
        A: "EST_ID"
        B: "Item"
        C: "Final_Value"  # 비어있으면 안 됨!
        D: "Used_In"  # 비어있으면 안 됨!
        E: "Confidence"  # 비어있으면 안 됨!
      
      data_start_row: 5
      min_rows: 6  # 6개 추정치
      
      validation:
        - "C열 (Final_Value) 모두 채워져야 함"
        - "D열 (Used_In) 모두 채워져야 함"
        - "E열 (Confidence) 모두 채워져야 함"

