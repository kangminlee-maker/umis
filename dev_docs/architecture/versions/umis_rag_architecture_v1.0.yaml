# ========================================
# UMIS Advanced RAG Architecture v1.0
# ========================================
# 
# ëª©ì : UMIS 5ê°œ ì—ì´ì „íŠ¸ë¥¼ ìœ„í•œ Multi-Layer RAG ì‹œìŠ¤í…œ
# ì² í•™: Single Source of Truth + Multi-Perspective Views
# ì™„ì„±ë„: Path C (ì™„ì „ êµ¬í˜„ - 3ì£¼ ê°œë°œ)
#
# ========================================

_meta:
  version: "1.0"
  created: "2025-11-01"
  umis_version: "6.2"
  architecture_type: "Multi-Layer Graph-Vector Hybrid RAG"
  philosophy: "Single Source with Multi-Perspective Intelligence"

# ========================================
# Layer 1: Vector RAG (Content Search)
# @layer: content_search
# ========================================

layer_1_vector_rag:
  _id: "content_search_layer"
  _description: "ì˜ë¯¸ì  ìœ ì‚¬ë„ ê¸°ë°˜ ì½˜í…ì¸  ê²€ìƒ‰"
  _status: "implemented"  # âœ… ì™„ë£Œ
  
  technology:
    vector_db: "Chroma DB"
    embeddings: 
      model: "text-embedding-3-large"
      dimension: 3072
      provider: "OpenAI"
      cost: "$0.13 / 1M tokens"
    
    rationale_for_large:
      - "í–¥í›„ ëŒ€ìš©ëŸ‰ ë¹„ì •í˜• ë°ì´í„° ëŒ€ë¹„"
      - "ë¯¸ë¬˜í•œ ë¬¸ë§¥ ì°¨ì´ ì¸ì‹ (ê¸ì •/ë¶€ì •)"
      - "ë¹„ìš© ì°¨ì´ ë¯¸ë¯¸ (~$10/ë…„)"
      - "UMIS = ì „ë¬¸ê°€ ì‹œìŠ¤í…œ, í’ˆì§ˆ ìš°ì„ "
  
  storage_model:
    collection: "umis_knowledge_base"  # ë‹¨ì¼ ì»¬ë ‰ì…˜
    strategy: "multi_view_chunks"
    
    chunk_structure:
      - agent_view: "albert"
        chunking_level: ["macro", "meso", "micro"]
        avg_size: "500-800 tokens"
        
      - agent_view: "steve"
        chunking_level: ["pattern", "section", "case"]
        avg_size: "400-800 tokens"
        
      - agent_view: "bill"
        chunking_level: ["report", "calculation", "metric"]
        avg_size: "200-500 tokens"
        
      - agent_view: "rachel"
        chunking_level: ["full_report", "verification", "source"]
        avg_size: "200-400 tokens"
        
      - agent_view: "stewart"
        chunking_level: ["summary", "detail"]
        avg_size: "200-500 tokens"
  
  metadata_schema:
    core_metadata:
      _description: "ëª¨ë“  agentê°€ ê³µìœ "
      fields:
        - source_id: "ë°ì´í„° ì›ë³¸ ì‹ë³„ì (cross-reference í‚¤)"
        - source_file: "ì›ë³¸ íŒŒì¼ëª…"
        - domain: "['business_model', 'disruption', 'case_study', ...]"
        - category: "ì„¸ë¶€ ë¶„ë¥˜"
        - validation_status: "['verified', 'estimated', 'unverified']"
        - quality_grade: "['A', 'B', 'C', 'D']"
        - version: "6.2"
        - language: "ko"
        - created_at: "timestamp"
    
    agent_specific_metadata:
      steve:
        - steve_view_type: "['opportunity', 'strategy', 'validation', ...]"
        - steve_pattern_id: "íŒ¨í„´ ì‹ë³„ì"
        - steve_pattern_type: "['business_model', 'disruption']"
        - steve_triggers: "JSON string of triggers"
        - steve_csf: "JSON string of critical success factors"
        - steve_difficulty: "['low', 'medium', 'high']"
        - steve_chunking_level: "['pattern', 'section', 'case']"
      
      bill:
        - bill_view_type: "['quantitative', 'calculation', 'benchmark']"
        - bill_metrics: "JSON string of metrics"
        - bill_formulas: "JSON string of formulas"
        - bill_data_quality: "['verified', 'estimated', 'calculated']"
        - bill_has_numbers: "boolean (fast filtering)"
        - bill_chunking_level: "['report', 'calculation', 'metric']"
      
      rachel:
        - rachel_view_type: "['source', 'verification', 'reliability']"
        - rachel_sources: "JSON string of sources"
        - rachel_reliability: "['high', 'medium', 'low']"
        - rachel_data_gaps: "JSON string of gaps"
        - rachel_chunking_level: "['full_report', 'verification', 'source']"
      
      albert:
        - albert_view_type: "['structural', 'competitive', 'trend']"
        - albert_patterns: "JSON string of structural patterns"
        - albert_dynamics: "JSON string of market dynamics"
        - albert_chunking_level: "['macro', 'meso', 'micro']"
      
      stewart:
        - stewart_view_type: "['governance', 'quality', 'process']"
        - stewart_quality: "['A', 'B', 'C', 'D']"
        - stewart_validated: "boolean"
        - stewart_checked_by: "JSON string of validators"
        - stewart_chunking_level: "['summary', 'detail']"
    
    cross_reference:
      related_chunks: "JSON string of related chunk_ids (agentê°„ í˜‘ì—…)"
  
  retrieval_layers:
    _description: "Agentë³„ í•„í„°ë§ ê²€ìƒ‰ ë ˆì´ì–´"
    
    steve_retriever:
      base_filter: 
        agent_view: "steve"
      
      methods:
        - name: "search_by_trigger"
          filter:
            - steve_view_type: "opportunity"
            - steve_chunking_level: ["pattern", "section"]
          use_case: "Albert íŠ¸ë¦¬ê±° â†’ íŒ¨í„´ ë§¤ì¹­"
        
        - name: "search_cases_by_industry"
          filter:
            - steve_view_type: "case_learning"
            - steve_chunking_level: "case"
          use_case: "ìœ ì‚¬ ì‚°ì—… ì„±ê³µ ì‚¬ë¡€ ê²€ìƒ‰"
        
        - name: "get_validation_framework"
          filter:
            - steve_view_type: "validation"
          use_case: "ê²€ì¦ ë°©ë²• í™•ì¸"
    
    bill_retriever:
      base_filter:
        agent_view: "bill"
      
      methods:
        - name: "search_exact_metric"
          filter:
            - bill_chunking_level: "metric"
            - bill_has_numbers: true
          use_case: "íŠ¹ì • ìˆ«ìë§Œ ë¹ ë¥´ê²Œ"
        
        - name: "search_calculation"
          filter:
            - bill_chunking_level: "calculation"
          use_case: "ê³„ì‚° ê³¼ì • ì „ì²´"
    
    rachel_retriever:
      base_filter:
        agent_view: "rachel"
      
      methods:
        - name: "search_by_source"
          filter:
            - rachel_chunking_level: "source"
          use_case: "íŠ¹ì • ì¶œì²˜ ì •ë³´ í™•ì¸"
    
    albert_retriever:
      base_filter:
        agent_view: "albert"
      
      methods:
        - name: "search_structure"
          filter:
            - albert_view_type: "structural"
            - albert_chunking_level: ["macro", "meso"]
          use_case: "ì‹œì¥ êµ¬ì¡° ë¶„ì„"
    
    stewart_retriever:
      base_filter:
        agent_view: "stewart"
      
      methods:
        - name: "check_validation_status"
          filter:
            - stewart_chunking_level: "summary"
          use_case: "ë¹ ë¥¸ í’ˆì§ˆ í™•ì¸"

# ========================================
# Layer 2: Knowledge Graph (Relationships)
# @layer: knowledge_graph
# ========================================

layer_2_knowledge_graph:
  _id: "knowledge_graph_layer"
  _description: "ì§€ì‹ ê°„ ê´€ê³„ ë° ë…¼ë¦¬ ì²´ì¸ í‘œí˜„"
  _status: "planned"  # ğŸ”„ êµ¬í˜„ ì˜ˆì •
  _priority: "critical"  # â­â­â­â­â­
  
  technology:
    graph_db: "Neo4j"
    version: "5.x Community Edition"
    interface: "Python neo4j driver"
    query_language: "Cypher"
  
  node_types:
    
    pattern_nodes:
      label: "Pattern"
      properties:
        - id: "pattern_id (ì˜ˆ: 'platform_business_model')"
        - name: "íŒ¨í„´ëª…"
        - type: "['business_model', 'disruption']"
        - complexity: "['low', 'medium', 'high']"
        - success_rate: "float (historical)"
      
      examples:
        - id: "platform_business_model"
          name: "í”Œë«í¼ ì‚¬ì—…ëª¨ë¸"
          type: "business_model"
    
    case_nodes:
      label: "Case"
      properties:
        - id: "case_id (ì˜ˆ: 'baemin_case')"
        - company: "ê¸°ì—…ëª…"
        - industry: "ì‚°ì—…"
        - outcome: "ì„±ê³µ/ì‹¤íŒ¨"
        - year: "ì‹œê¸°"
      
      examples:
        - id: "baemin_case"
          company: "ë°°ë‹¬ì˜ë¯¼ì¡±"
          outcome: "success"
    
    agent_output_nodes:
      label: "AgentOutput"
      properties:
        - id: "output_id"
        - agent: "['albert', 'steve', 'bill', 'rachel']"
        - type: "['observation', 'hypothesis', 'calculation', 'verification']"
        - quality_grade: "['A', 'B', 'C', 'D']"
        - validated: "boolean"
    
    data_nodes:
      label: "Data"
      properties:
        - id: "data_id"
        - value: "ì‹¤ì œ ë°ì´í„°"
        - type: "['statistic', 'metric', 'quote']"
        - reliability: "['high', 'medium', 'low']"
    
    source_nodes:
      label: "Source"
      properties:
        - id: "src_id (ì˜ˆ: 'SRC_001')"
        - type: "['government', 'company_official', 'news', 'research']"
        - url: "URL"
        - reliability: "['high', 'medium', 'low']"
  
  relationship_types:
    
    pattern_relationships:
      _description: "íŒ¨í„´ ê°„ ê´€ê³„ (UMIS í•µì‹¬!)"
      
      - type: "COMBINES_WITH"
        direction: "Pattern -> Pattern"
        properties:
          synergy: "ì¡°í•© ì‹œ ì‹œë„ˆì§€ (ì˜ˆ: 'ì¶©ì„±ë„â†‘ + ì•ˆì •ìˆ˜ìµ')"
          example: "ì„±ê³µ ì‚¬ë¡€"
          success_rate: "float (0-1)"
          mechanism: "ì‘ë™ ì›ë¦¬"
        
        examples:
          - from: "platform_business_model"
            to: "subscription_model"
            synergy: "í”Œë«í¼ ì¶©ì„±ë„ í–¥ìƒ + ì˜ˆì¸¡ ê°€ëŠ¥ ìˆ˜ìµ"
            example: "Amazon Prime"
            success_rate: 0.8
          
          - from: "subscription_model"
            to: "direct_to_consumer_model"
            synergy: "ì§ì ‘ ê´€ê³„ + ë°˜ë³µ ìˆ˜ìµ"
            example: "Dollar Shave Club"
            success_rate: 0.75
      
      - type: "COUNTERS"
        direction: "Pattern -> Pattern"
        properties:
          target_weakness: "ê³µëµí•˜ëŠ” ì•½ì "
          mechanism: "Counter-Positioning ë©”ì»¤ë‹ˆì¦˜"
        
        examples:
          - from: "low_end_disruption"
            to: "premium_trap"
            target_weakness: "ê³¼ì‰ ê¸°ëŠ¥, ê³ ê°€ ì „ëµ"
            mechanism: "Good Enough ì œí’ˆìœ¼ë¡œ ì €ê°€ ê³µëµ"
      
      - type: "PREREQUISITE"
        direction: "Pattern -> Pattern"
        properties:
          reason: "ì„ í–‰ ì¡°ê±´ ì´ìœ "
        
        examples:
          - from: "platform_business_model"
            to: "network_effect"
            reason: "í”Œë«í¼ì€ ë„¤íŠ¸ì›Œí¬ íš¨ê³¼ í™•ë³´ í•„ìˆ˜"
      
      - type: "ALTERNATIVE"
        direction: "Pattern <-> Pattern"
        properties:
          trade_off: "íŠ¸ë ˆì´ë“œì˜¤í”„"
        
        examples:
          - pattern1: "franchise_model"
            pattern2: "direct_to_consumer_model"
            trade_off: "ë¹ ë¥¸ í™•ì¥ vs ë†’ì€ ë§ˆì§„"
    
    validation_relationships:
      _description: "ê²€ì¦ ì²´ì¸ (Stewart í•µì‹¬!)"
      
      - type: "OBSERVED_BY"
        direction: "Data -> AlbertOutput"
        properties:
          observation_type: "['structure', 'trend', 'competition']"
      
      - type: "TRIGGERS"
        direction: "AlbertOutput -> SteveHypothesis"
        properties:
          trigger_signals: "JSON array"
      
      - type: "BASED_ON"
        direction: "SteveHypothesis -> Pattern"
        properties:
          pattern_id: "ì ìš© íŒ¨í„´"
          adaptation: "ì–´ë–»ê²Œ ì¡°ì •í–ˆë‚˜"
      
      - type: "REFERENCES"
        direction: "SteveHypothesis -> Case"
        properties:
          similarity: "ìœ ì‚¬ë„ ì ìˆ˜"
          learning_point: "ë°°ìš´ ì "
      
      - type: "REQUIRES_VALIDATION"
        direction: "SteveHypothesis -> BillCalculation"
        properties:
          validation_type: "['market_size', 'roi', 'growth_rate']"
      
      - type: "CALCULATED_FROM"
        direction: "BillCalculation -> Data"
        properties:
          formula: "ê³„ì‚°ì‹"
          assumptions: "ê°€ì • ì‚¬í•­"
      
      - type: "SOURCED_FROM"
        direction: "Data -> Source"
        properties:
          src_id: "SRC_XXX"
          extraction_method: "ì¶”ì¶œ ë°©ë²•"
      
      - type: "VERIFIED_BY"
        direction: "Source -> RachelVerification"
        properties:
          verification_date: "ê²€ì¦ ë‚ ì§œ"
          reliability: "['high', 'medium', 'low']"
          notes: "ê²€ì¦ ë…¸íŠ¸"
      
      - type: "APPROVED_BY"
        direction: "SteveHypothesis -> StewartApproval"
        properties:
          grade: "['A', 'B', 'C', 'D']"
          approval_date: "ìŠ¹ì¸ ë‚ ì§œ"
          conditions: "ì¡°ê±´ë¶€ ìŠ¹ì¸ ì‚¬í•­"
      
      - type: "REQUIRES_IMPROVEMENT"
        direction: "StewartApproval -> SteveHypothesis"
        properties:
          feedback: "ê°œì„  í•„ìš” ì‚¬í•­"
          iteration: "ë°˜ë³µ íšŸìˆ˜"
    
    learning_relationships:
      _description: "í•™ìŠµ ë° í”¼ë“œë°± ê´€ê³„"
      
      - type: "LEARNED_FROM"
        direction: "SuccessfulQuery -> Pattern"
        properties:
          query_text: "ì„±ê³µí•œ ì¿¼ë¦¬"
          success_count: "ì„±ê³µ íšŸìˆ˜"
          avg_quality_grade: "í‰ê·  í’ˆì§ˆ"
      
      - type: "FAILED_WITH"
        direction: "FailedQuery -> Pattern"
        properties:
          query_text: "ì‹¤íŒ¨í•œ ì¿¼ë¦¬"
          failure_reason: "ì‹¤íŒ¨ ì´ìœ "
          correction: "ìˆ˜ì • ë°©ë²•"
  
  cross_agent_collaboration:
    _description: "source_id ê¸°ë°˜ í˜‘ì—…"
    
    workflow:
      - step: 1
        agent: "steve"
        action: "ì‚¬ë¡€ ê²€ìƒ‰"
        output: "steve_baemin_opportunity (source_id: 'baemin_case')"
      
      - step: 2
        agent: "steve"
        trigger: "ì •ëŸ‰ ë°ì´í„° í•„ìš”"
        action: "source_idë¡œ Bill ê²€ìƒ‰"
        query: "filter: {source_id: 'baemin_case', agent_view: 'bill'}"
      
      - step: 3
        agent: "bill"
        return: "bill_baemin_metrics (ê°™ì€ source_id!)"
      
      - step: 4
        agent: "steve"
        action: "ê°€ì„¤ ìƒì„± (Bill ë°ì´í„° í¬í•¨)"

# ========================================
# Layer 3: Meta-Learning (Validation & Feedback)
# @layer: meta_learning
# ========================================

layer_3_meta_learning:
  _id: "meta_learning_layer"
  _description: "ê²€ì¦ ìë™í™” + í”¼ë“œë°± í•™ìŠµ"
  _status: "planned"  # ğŸ”„ êµ¬íš ì˜ˆì •
  _priority: "critical"  # â­â­â­â­â­
  
  stewart_meta_rag:
    _description: "Stewart ì „ìš© Meta-RAG ì‹œìŠ¤í…œ"
    _purpose: "ë‹¤ë¥¸ agent ê²°ê³¼ë¬¼ ê²€ì¦"
    
    specialized_indices:
      
      validation_rules_index:
        collection_name: "validation_rules"
        content_type: "ê²€ì¦ ê·œì¹™ ë° ì²´í¬ë¦¬ìŠ¤íŠ¸"
        
        chunk_examples:
          - rule_id: "steve_hypothesis_rules"
            content: |
              Steve ê°€ì„¤ í•„ìˆ˜ ìš”ê±´:
              1. Albert ê´€ì°° ëª…ì‹œì  ì¸ìš©
              2. íŒ¨í„´ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì°¸ì¡° (pattern_id)
              3. ìœ ì‚¬ ì‚¬ë¡€ ìµœì†Œ 2ê°œ ì¸ìš©
              4. Bill ì •ëŸ‰ ê·¼ê±° í¬í•¨
              5. Rachel ì¶œì²˜ ê²€ì¦ ì™„ë£Œ
            mandatory: true
            checkpoint: "phase_6"
          
          - rule_id: "bill_calculation_rules"
            content: |
              Bill ê³„ì‚° í•„ìˆ˜ ìš”ê±´:
              1. ê³„ì‚°ì‹ ëª…ì‹œ (Excel í•¨ìˆ˜ ìˆ˜ì¤€)
              2. ê°€ì • ì‚¬í•­ íˆ¬ëª… ê³µê°œ
              3. ì¶”ì •ì¹˜ EST_ID ë¶€ì—¬
              4. Rachel ë°ì´í„° ê²€ì¦ í•„ìˆ˜
            mandatory: true
            checkpoint: "phase_4"
      
      quality_patterns_index:
        collection_name: "quality_patterns"
        content_type: "ì¢‹ì€/ë‚˜ìœ ì˜ˆì‹œ (í•™ìŠµìš©)"
        
        chunk_examples:
          - example_id: "good_steve_hypothesis_001"
            quality_grade: "A"
            agent: "steve"
            content: |
              ê°€ì„¤: "í”¼ì•„ë…¸ êµ¬ë… ì„œë¹„ìŠ¤"
              
              âœ… Albert ì¸ìš©: "ë†’ì€ ì´ˆê¸° ë¹„ìš© (Albert ê´€ì°°)"
              âœ… íŒ¨í„´ ëª…ì‹œ: "subscription_model ì ìš©"
              âœ… ì‚¬ë¡€ ì°¸ì¡°: "ì½”ì›¨ì´ ì •ìˆ˜ê¸° ë Œíƒˆ (ìœ ì‚¬ êµ¬ì¡°)"
              âœ… Bill ê³„ì‚°: "TAM 50ë§Œ Ã— ì „í™˜ìœ¨ 20% = SAM 10ë§Œ"
              âœ… Rachel ê²€ì¦: "í•™ìŠµì ìˆ˜ëŠ” ì¶”ì •ì¹˜ (SRC_003)"
              
              â†’ Grade A ì´ìœ : ëª¨ë“  ê·¼ê±° ëª…í™•
            
            metadata:
              pattern_applied: "subscription_model"
              validation_complete: true
              stewart_approved: true
          
          - example_id: "bad_steve_hypothesis_001"
            quality_grade: "D"
            agent: "steve"
            content: |
              ê°€ì„¤: "AI êµìœ¡ ì‹œì¥ì€ ì„±ì¥í•  ê²ƒì´ë‹¤"
              
              âŒ Albert ì¸ìš© ì—†ìŒ
              âŒ íŒ¨í„´ ë¶ˆëª…í™•
              âŒ ì‚¬ë¡€ ì—†ìŒ
              âŒ ì •ëŸ‰ ê·¼ê±° ì—†ìŒ
              âŒ ì¶œì²˜ ë¶ˆëª…
              
              â†’ Grade D ì´ìœ : ê·¼ê±° ì „ë¬´
            
            metadata:
              common_mistakes:
                - "ê·¼ê±° ì—†ëŠ” ì£¼ì¥"
                - "íŒ¨í„´ ë¯¸ì ìš©"
                - "ê²€ì¦ ë¶ˆê°€ëŠ¥"
      
      agent_outputs_index:
        collection_name: "agent_outputs_history"
        content_type: "ê³¼ê±° agent ê²°ê³¼ë¬¼ (í•™ìŠµìš©)"
        
        purpose:
          - "ì¢‹ì€ ê²°ê³¼ë¬¼ íŒ¨í„´ í•™ìŠµ"
          - "ì‹¤íŒ¨ ì‚¬ë¡€ì—ì„œ ë°°ì›€"
          - "ì‹œê°„ì— ë”°ë¥¸ í’ˆì§ˆ ì¶”ì "
    
    validation_engine:
      _description: "Stewartì˜ 3ë‹¨ê³„ ê²€ì¦"
      
      stage_1_rule_based:
        name: "í•„ìˆ˜ ì¡°ê±´ ê²€ì¦"
        method: "Rule-based matching"
        
        process:
          - load: "validation_rules_index"
          - query: "agentë³„ í•„ìˆ˜ ê·œì¹™"
          - check: "ëª¨ë“  í•„ìˆ˜ ì¡°ê±´ ë§Œì¡±?"
          - result: "PASS/FAIL + ëˆ„ë½ í•­ëª©"
        
        fail_action: "ì¦‰ì‹œ ê±°ë¶€, Grade D"
      
      stage_2_pattern_based:
        name: "í’ˆì§ˆ íŒ¨í„´ ë¹„êµ"
        method: "Vector similarity with quality_patterns"
        
        process:
          - load: "quality_patterns_index"
          - query: "ìœ ì‚¬ Grade A ì˜ˆì‹œ ê²€ìƒ‰"
          - compare: "í˜„ì¬ ê²°ê³¼ë¬¼ vs Grade A ìœ ì‚¬ë„"
          - threshold: "similarity > 0.7"
        
        fail_action: "ìˆ˜ì • ê¶Œê³ , Grade C"
      
      stage_3_graph_based:
        name: "ë…¼ë¦¬ ì²´ì¸ ê²€ì¦"
        method: "Graph traversal"
        
        process:
          - load: "Knowledge Graph"
          - trace: "Steve ê°€ì„¤ â†’ Albert â†’ Bill â†’ Rachel â†’ Source"
          - check: "ëª¨ë“  ë§í¬ ê²€ì¦ë¨?"
          - find_gaps: "ëŠê¸´ ì²´ì¸ ë°œê²¬"
        
        fail_action: "Gap ì§€ì , Grade B"
      
      final_decision:
        all_pass: "Grade A, APPROVE"
        stage_1_fail: "Grade D, REJECT"
        stage_2_fail: "Grade C, REVISE"
        stage_3_fail: "Grade B, FILL_GAPS"
  
  adaptive_learning:
    _description: "í”¼ë“œë°± ê¸°ë°˜ í•™ìŠµ ì‹œìŠ¤í…œ"
    
    query_refinement:
      technology: "LLM (GPT-4)"
      
      process:
        - initial_query: "Steveì˜ ì²« ê²€ìƒ‰"
        - validation: "Stewart ê²€ì¦"
        - feedback: "ë¶€ì¡±í•œ ì  ì§€ì "
        - refinement: "LLMìœ¼ë¡œ ì¿¼ë¦¬ ì¬ì‘ì„±"
        - retry: "ê°œì„ ëœ ì¿¼ë¦¬ë¡œ ì¬ê²€ìƒ‰"
        - max_iterations: 3
      
      example:
        iteration_1:
          query: "í”Œë«í¼ ê¸°íšŒ"
          result: "platform_business_model"
          stewart_feedback: "Bill ë°ì´í„° ê·¼ê±° ë¶€ì¡±"
          action: "REVISE"
        
        iteration_2:
          query: "í”Œë«í¼ ê¸°íšŒ + ì‹œì¥ ê·œëª¨ ê³„ì‚° ê·¼ê±°"
          result: "platform + validation_framework"
          stewart_feedback: "Rachel ì¶œì²˜ ê²€ì¦ í•„ìš”"
          action: "REVISE"
        
        iteration_3:
          query: "í”Œë«í¼ ê¸°íšŒ + ì •ëŸ‰ ê·¼ê±° + ì¶œì²˜ ê²€ì¦"
          result: "ì™„ì „í•œ ì»¨í…ìŠ¤íŠ¸"
          stewart_feedback: "ìŠ¹ì¸"
          action: "APPROVE"
        
        learning:
          successful_query: "í”Œë«í¼ + ì •ëŸ‰ + ì¶œì²˜"
          store: "successful_queries DB"
          reuse: "ë‹¤ìŒ í”Œë«í¼ ë¶„ì„ ì‹œ ìë™ ì ìš©"
    
    weighted_retrieval:
      _description: "ì²­í¬ë³„ ê°€ì¤‘ì¹˜ í•™ìŠµ"
      
      mechanism:
        initial_weight: 1.0
        
        update_rule:
          on_approval: "weight Ã— 1.1"
          on_rejection: "weight Ã— 0.9"
          on_revision: "weight Ã— 0.95"
        
        decay:
          time_based: "1ë…„ ì§€ë‚˜ë©´ weight Ã— 0.95"
          reason: "ìµœì‹  ì •ë³´ ìš°ì„ "
      
      storage:
        database: "SQLite"
        table: "chunk_weights"
        schema:
          - chunk_id: "TEXT PRIMARY KEY"
          - weight: "REAL"
          - success_count: "INTEGER"
          - total_used: "INTEGER"
          - last_updated: "TIMESTAMP"
      
      retrieval_integration:
        step_1: "Vector searchë¡œ Top-20 ê²€ìƒ‰"
        step_2: "ê° ì²­í¬ì˜ ê°€ì¤‘ì¹˜ ì ìš©"
        step_3: "Final score = vector_score Ã— weight"
        step_4: "Re-ranking í›„ Top-K ë°˜í™˜"
    
    reinforcement_learning:
      _description: "Multi-Armed Bandits for Pattern Selection"
      _type: "optional"  # ì„ íƒì  ê³ ê¸‰ ê¸°ëŠ¥
      
      concept:
        arms: "ê° íŒ¨í„´ = Arm"
        reward: "Stewart ìŠ¹ì¸ = +1, ê±°ë¶€ = 0"
        strategy: "Epsilon-Greedy"
      
      parameters:
        epsilon: 0.1  # 10% íƒìƒ‰, 90% í™œìš©
        learning_rate: 0.05
      
      application:
        - pattern_selection: "ì—¬ëŸ¬ ë§¤ì¹­ íŒ¨í„´ ì¤‘ ì„ íƒ"
        - case_selection: "ì—¬ëŸ¬ ì‚¬ë¡€ ì¤‘ ìš°ì„ ìˆœìœ„"
        - query_strategy: "ê²€ìƒ‰ ì „ëµ ìµœì í™”"

# ========================================
# Agent-Specific RAG Configurations
# @section: agent_configs
# ========================================

agent_rag_configurations:
  
  albert:
    _role: "Observer (ì‹œì¥ êµ¬ì¡° ë¶„ì„)"
    
    rag_characteristics:
      focus: "êµ¬ì¡°, ì—­í•™, íŠ¸ë Œë“œ"
      chunking_preference: "meso (êµ¬ì¡° ìš”ì†Œë³„)"
      search_mode: "broad_then_deep"
      
      typical_queries:
        - "ì‹œì¥ êµ¬ì¡° ë³€í™” íŒ¨í„´"
        - "ê²½ìŸ êµ¬ë„ ì¬í¸"
        - "ê°€ì¹˜ì‚¬ìŠ¬ ë³€í™”"
      
      output_to_graph:
        - type: "AlbertObservation"
          links_to: ["Data", "Source", "SteveHypothesis"]
    
    dependencies:
      requires:
        - rachel: "ë°ì´í„° ê²€ì¦"
        - bill: "ì •ëŸ‰ ë°ì´í„°"
      
      provides_to:
        - steve: "íŠ¸ë¦¬ê±° ì‹œê·¸ë„"
        - owner: "ì‹œì¥ êµ¬ì¡° ë¶„ì„"
  
  steve:
    _role: "Explorer (ê¸°íšŒ ë°œêµ´)"
    
    rag_characteristics:
      focus: "ê¸°íšŒ, ì „ëµ, ì‹¤í–‰"
      chunking_preference: "case (ì‚¬ë¡€ ì™„ê²°ì„±)"
      search_mode: "pattern_matching_then_case_learning"
      
      typical_queries:
        - "íŠ¸ë¦¬ê±° ì‹œê·¸ë„ â†’ íŒ¨í„´ ë§¤ì¹­"
        - "ìœ ì‚¬ ì‚°ì—… ì„±ê³µ ì‚¬ë¡€"
        - "ê²€ì¦ í”„ë ˆì„ì›Œí¬"
      
      multi_stage_search:
        stage_1:
          query: "Albert íŠ¸ë¦¬ê±° ì‹œê·¸ë„"
          target: "pattern_overview ì²­í¬"
          filter: "steve_view_type='opportunity'"
        
        stage_2:
          query: "ì‚°ì—…/êµ¬ì¡° ìœ ì‚¬ì„±"
          target: "success_case ì²­í¬"
          filter: "steve_pattern_id=ë§¤ì¹­ëœíŒ¨í„´"
        
        stage_3:
          query: "ê²€ì¦ ë°©ë²•"
          target: "validation_framework ì²­í¬"
          filter: "steve_pattern_id=ë§¤ì¹­ëœíŒ¨í„´"
      
      output_to_graph:
        - type: "SteveHypothesis"
          links_to: ["AlbertObservation", "Pattern", "Case", "BillCalculation"]
    
    dependencies:
      requires:
        - albert: "ì‹œì¥ ê´€ì°° (íŠ¸ë¦¬ê±°)"
        - bill: "ì •ëŸ‰ ê²€ì¦"
        - rachel: "ë°ì´í„° ì‹ ë¢°ë„"
      
      provides_to:
        - stewart: "ê°€ì„¤ (ê²€ì¦ ëŒ€ìƒ)"
        - owner: "ê¸°íšŒ í¬íŠ¸í´ë¦¬ì˜¤"
  
  bill:
    _role: "Quantifier (ì •ëŸ‰ ë¶„ì„)"
    
    rag_characteristics:
      focus: "ìˆ«ì, ê³„ì‚°, ë©”íŠ¸ë¦­"
      chunking_preference: "calculation (ê³„ì‚° ë‹¨ìœ„)"
      search_mode: "metric_first"
      
      typical_queries:
        - "íŠ¹ì • ë©”íŠ¸ë¦­ë§Œ (MAU, GMV, ...)"
        - "ê³„ì‚° ê³¼ì • ì „ì²´"
        - "ë²¤ì¹˜ë§ˆí¬ ë°ì´í„°"
      
      specialized_search:
        exact_metric_search:
          chunking_level: "metric"
          filter: "bill_has_numbers=true"
          speed: "fastest (<50ms)"
        
        calculation_search:
          chunking_level: "calculation"
          includes: "formula + assumptions"
          speed: "fast (<100ms)"
      
      output_to_graph:
        - type: "BillCalculation"
          links_to: ["Data", "Formula", "Assumptions"]
    
    dependencies:
      requires:
        - rachel: "ë°ì´í„° ê²€ì¦ í•„ìˆ˜"
      
      provides_to:
        - steve: "ì •ëŸ‰ ê·¼ê±°"
        - albert: "ì •ëŸ‰ ë°ì´í„°"
        - owner: "ìˆ˜ìµì„± ë¶„ì„"
  
  rachel:
    _role: "Validator (ë°ì´í„° ê²€ì¦)"
    
    rag_characteristics:
      focus: "ì¶œì²˜, ì‹ ë¢°ë„, ê²€ì¦"
      chunking_preference: "source (ì¶œì²˜ë³„)"
      search_mode: "source_tracing"
      
      typical_queries:
        - "íŠ¹ì • ë°ì´í„°ì˜ ì¶œì²˜"
        - "ì‹ ë¢°ë„ í‰ê°€"
        - "ë°ì´í„° Gap ë¶„ì„"
      
      source_registry_integration:
        _umis_standard: "source_registry.yaml ì—°ë™"
        
        workflow:
          - input: "Billì˜ ë°ì´í„° í¬ì¸íŠ¸"
          - search: "í•´ë‹¹ ë°ì´í„°ì˜ ì¶œì²˜ ì²­í¬"
          - verify: "ì‹ ë¢°ë„ í™•ì¸"
          - output: "SRC_ID + ì‹ ë¢°ë„ + Gap ë¶„ì„"
      
      output_to_graph:
        - type: "RachelVerification"
          links_to: ["Data", "Source", "Reliability"]
    
    dependencies:
      requires: []  # ë…ë¦½ì 
      
      provides_to:
        - albert: "ë°ì´í„° ê²€ì¦"
        - steve: "ì‹ ë¢°ë„ í™•ì¸"
        - bill: "ë°ì´í„° ê²€ì¦"
        - stewart: "ê²€ì¦ ì™„ë£Œ í™•ì¸"
  
  stewart:
    _role: "Guardian (í”„ë¡œì„¸ìŠ¤ ê°ì‹œ + í’ˆì§ˆ ê´€ë¦¬)"
    
    rag_characteristics:
      focus: "ê²€ì¦ ìƒíƒœ, í’ˆì§ˆ, ë…¼ë¦¬ ì²´ì¸"
      chunking_preference: "summary (ë¹ ë¥¸ í™•ì¸)"
      search_mode: "validation_chain_tracing"
      
      specialized_capabilities:
        
        meta_search:
          _description: "ë‹¤ë¥¸ agent ê²°ê³¼ë¬¼ ê²€ìƒ‰"
          
          search_albert_output:
            collection: "umis_knowledge_base"
            filter: "agent_view='albert'"
            purpose: "Albert ê²°ë¡  ê²€ì¦"
          
          search_steve_output:
            collection: "umis_knowledge_base"
            filter: "agent_view='steve'"
            purpose: "Steve ê°€ì„¤ ê²€ì¦"
        
        graph_traversal:
          _description: "ë…¼ë¦¬ ì²´ì¸ ì¶”ì "
          
          trace_hypothesis_chain:
            start: "SteveHypothesis"
            traverse: "BASED_ON, REQUIRES_VALIDATION, SOURCED_FROM, VERIFIED_BY"
            check: "ëª¨ë“  ë§í¬ ê²€ì¦ë¨?"
            output: "ì™„ê²°ì„± ì ìˆ˜ + Gap ë¦¬ìŠ¤íŠ¸"
          
          find_validation_gaps:
            query: |
              MATCH path = (s:SteveHypothesis {id: $hypothesis_id})
                           -[:BASED_ON|REQUIRES_VALIDATION*1..10]->(data)
              WHERE NOT (data)-[:VERIFIED_BY]->()
              RETURN data as unverified_data
            
            output: "ë¯¸ê²€ì¦ ë°ì´í„° í¬ì¸íŠ¸ ë¦¬ìŠ¤íŠ¸"
        
        quality_comparison:
          _description: "í’ˆì§ˆ íŒ¨í„´ê³¼ ë¹„êµ"
          
          compare_with_grade_a:
            index: "quality_patterns_index"
            filter: "quality_grade='A'"
            similarity_threshold: 0.7
            
            result:
              high_similarity: "Grade A ê°€ëŠ¥"
              medium_similarity: "Grade B-C"
              low_similarity: "Grade D, ì¬ì‘ì„± í•„ìš”"
      
      output_to_graph:
        - type: "StewartApproval"
          links_to: ["SteveHypothesis", "ValidationResult", "QualityGrade"]
        
        - type: "StewartFeedback"
          links_to: ["Gap", "ImprovementSuggestion"]
    
    dependencies:
      requires:
        - "ëª¨ë“  agentì˜ ê²°ê³¼ë¬¼ ì ‘ê·¼"
      
      provides_to:
        - owner: "ìµœì¢… í’ˆì§ˆ ë³´ì¦"
        - "ëª¨ë“  agent": "í”¼ë“œë°±"

# ========================================
# Feedback Loop System
# @section: feedback_system
# ========================================

feedback_loop_system:
  _id: "umis_feedback_loop"
  _description: "UMIS í•µì‹¬ - ì ì§„ì  í’ˆì§ˆ í–¥ìƒ"
  _umis_principle: "ê°€ì„¤ê³¼ íŒë‹¨ì—ëŠ” ê·¼ê±°ì™€ ê²€ì¦ì´ í•„ìš”í•˜ë‹¤"
  
  loop_structure:
    
    iteration_1:
      steve_action: "ì´ˆê¸° ê°€ì„¤ ìƒì„±"
      steve_query: "ê¸°ë³¸ íŒ¨í„´ ê²€ìƒ‰"
      steve_output: "ê°€ì„¤ v1 (ê¸°ë³¸)"
      
      stewart_validation: "3ë‹¨ê³„ ê²€ì¦"
      stewart_result: 
        stage_1: "PASS (í•„ìˆ˜ ì¡°ê±´ ë§Œì¡±)"
        stage_2: "FAIL (í’ˆì§ˆ íŒ¨í„´ê³¼ ì°¨ì´)"
        stage_3: "PASS (ë…¼ë¦¬ ì²´ì¸ ì™„ê²°)"
      
      stewart_feedback:
        grade: "C"
        action: "REVISE"
        specific: "Bill ì •ëŸ‰ ê·¼ê±° ì•½í•¨, êµ¬ì²´ì  ê³„ì‚° í•„ìš”"
      
      learning:
        query_weight: "ì´ˆê¸° ì¿¼ë¦¬ ê°€ì¤‘ì¹˜ ê°ì†Œ (Ã— 0.95)"
        pattern: "ì´ ì¿¼ë¦¬ íŒ¨í„´ì€ Grade C ìˆ˜ì¤€"
    
    iteration_2:
      steve_action: "ì¿¼ë¦¬ ê°œì„  (LLM)"
      steve_query: "íŒ¨í„´ + ê²€ì¦ í”„ë ˆì„ì›Œí¬ í•¨ê»˜ ê²€ìƒ‰"
      steve_output: "ê°€ì„¤ v2 (Bill ê³„ì‚° í¬í•¨)"
      
      stewart_validation: "3ë‹¨ê³„ ì¬ê²€ì¦"
      stewart_result:
        stage_1: "PASS"
        stage_2: "PASS (í’ˆì§ˆ í–¥ìƒ)"
        stage_3: "FAIL (Rachel ê²€ì¦ ë¯¸ì™„ë£Œ)"
      
      stewart_feedback:
        grade: "B"
        action: "FILL_GAPS"
        specific: "Rachelì—ê²Œ SRC_003 ê²€ì¦ ìš”ì²­"
      
      learning:
        improvement: "iteration_1 â†’ iteration_2 í’ˆì§ˆ í–¥ìƒ"
        pattern: "ê²€ì¦ í”„ë ˆì„ì›Œí¬ í¬í•¨ = íš¨ê³¼ì "
    
    iteration_3:
      steve_action: "Rachel ê²€ì¦ ì¶”ê°€"
      steve_query: "ì™„ì „í•œ ê²€ìƒ‰ (í•™ìŠµëœ íŒ¨í„´)"
      steve_output: "ê°€ì„¤ v3 (ì™„ì „)"
      
      stewart_validation: "3ë‹¨ê³„ ì¬ê²€ì¦"
      stewart_result:
        stage_1: "PASS"
        stage_2: "PASS"
        stage_3: "PASS"
      
      stewart_feedback:
        grade: "A"
        action: "APPROVE"
      
      learning:
        successful_pattern: "íŒ¨í„´ + ê³„ì‚° + ì¶œì²˜ = Grade A"
        store: "ì„±ê³µ íŒ¨í„´ DBì— ì €ì¥"
        weight_update: "ì‚¬ìš©ëœ ì²­í¬ ê°€ì¤‘ì¹˜ Ã— 1.1"
        next_time: "ì´ ì¡°í•©ì„ ìë™ìœ¼ë¡œ ìš°ì„  ê²€ìƒ‰"
  
  feedback_storage:
    database: "SQLite"
    
    tables:
      successful_queries:
        schema:
          - query_id: "TEXT PRIMARY KEY"
          - query_text: "TEXT"
          - agent: "TEXT"
          - pattern_used: "TEXT"
          - quality_grade: "TEXT"
          - iteration_count: "INTEGER"
          - chunks_used: "JSON"
          - created_at: "TIMESTAMP"
        
        purpose: "ì„±ê³µ íŒ¨í„´ ì¬ì‚¬ìš©"
      
      failed_queries:
        schema:
          - query_id: "TEXT PRIMARY KEY"
          - query_text: "TEXT"
          - failure_reason: "TEXT"
          - stewart_feedback: "TEXT"
          - correction: "TEXT"
        
        purpose: "ì‹¤íŒ¨ì—ì„œ í•™ìŠµ"
      
      chunk_performance:
        schema:
          - chunk_id: "TEXT PRIMARY KEY"
          - usage_count: "INTEGER"
          - approval_count: "INTEGER"
          - rejection_count: "INTEGER"
          - avg_quality_grade: "REAL"
          - current_weight: "REAL"
        
        purpose: "ì²­í¬ë³„ ì„±ëŠ¥ ì¶”ì "

# ========================================
# Integration with UMIS Guidelines
# @section: umis_integration
# ========================================

umis_guidelines_integration:
  _description: "UMIS v6.2 Guidelinesì™€ì˜ í†µí•©"
  
  mandatory_validation_checkpoints:
    _umis_reference: "SECTION 4: Support & Validation System"
    
    checkpoint_1:
      phase: "Albert êµ¬ì¡° ë¶„ì„ ì™„ë£Œ"
      validators: ["bill", "rachel", "stewart"]
      
      rag_implementation:
        stewart_check:
          - graph_query: "Albert ê²°ë¡  â†’ Data â†’ Rachel ê²€ì¦ ì²´ì¸ í™•ì¸"
          - rule_check: "êµ¬ì¡° ë¶„ì„ í•„ìˆ˜ ê·œì¹™ ë§Œì¡±?"
          - quality_check: "Grade A êµ¬ì¡° ë¶„ì„ê³¼ ìœ ì‚¬ë„?"
    
    checkpoint_2:
      phase: "Steve ê¸°íšŒ ê°€ì„¤ ìƒì„±"
      validators: ["albert", "bill", "rachel"]
      
      rag_implementation:
        multi_agent_validation:
          albert_check:
            query: "Steve ê°€ì„¤ì´ Albert ê´€ì°°ì— ê·¼ê±°í•˜ëŠ”ê°€?"
            graph: "SteveHypothesis -[TRIGGERS]-> AlbertObservation"
          
          bill_check:
            query: "ì •ëŸ‰ ê·¼ê±° ì¶©ë¶„í•œê°€?"
            graph: "SteveHypothesis -[REQUIRES_VALIDATION]-> BillCalculation"
          
          rachel_check:
            query: "ë°ì´í„° ì¶œì²˜ ê²€ì¦ë˜ì—ˆë‚˜?"
            graph: "BillCalculation -> Data -> Source -> RachelVerification"
    
    checkpoint_3:
      phase: "Bill SAM ê³„ì‚° ì™„ë£Œ"
      validators: ["rachel", "stewart"]
      
      rag_implementation:
        rachel_check:
          query: "ëª¨ë“  ë°ì´í„°ì— SRC_ID?"
          graph: "Data -[SOURCED_FROM]-> Source"
        
        stewart_check:
          query: "ê³„ì‚° ë¡œì§ íˆ¬ëª…í•œê°€?"
          rule: "Estimation_Details 7ê°œ ì„¹ì…˜"
    
    checkpoint_4:
      phase: "Owner ìµœì¢… ì˜ì‚¬ê²°ì •"
      validators: ["stewart"]
      
      rag_implementation:
        stewart_final_check:
          query: "ì „ì²´ ë…¼ë¦¬ ì²´ì¸ ì™„ê²°?"
          graph: "Owner ê²°ì • â† Steve â† Albert â† Bill â† Rachel â† Source"
          completeness: "ëª¨ë“  ë§í¬ ê²€ì¦ë¨?"
  
  umis_workflows_mapping:
    
    discovery_sprint:
      _umis_reference: "adaptive_entry_gate"
      
      rag_support:
        parallel_exploration:
          - agent: "albert"
            rag_query: "ì‹œì¥ êµ¬ì¡° íŒ¨í„´ ê²€ìƒ‰"
            chunking: "macro (ì‹œì¥ ì „ì²´)"
          
          - agent: "steve"
            rag_query: "ì´ˆê¸° ê¸°íšŒ ìŠ¤ìº”"
            chunking: "pattern (ë¹ ë¥¸ ë§¤ì¹­)"
          
          - agent: "bill"
            rag_query: "ê·œëª¨ ì¶”ì • ë°©ë²•"
            chunking: "calculation"
        
        convergence:
          stewart_role: "5ê°œ agent ê²°ê³¼ í†µí•© ê²€ì¦"
          graph_query: "5ê°œ ê´€ì°°ì´ ì¼ê´€ë˜ëŠ”ê°€?"
    
    comprehensive_study:
      _umis_reference: "13ê°œ ì°¨ì› ë¶„ì„"
      
      rag_support:
        albert_13_dimensions:
          - dimension: "ì‹œì¥ ì •ì˜"
            rag_query: "ì‹œì¥ ê²½ê³„ ë° ì •ì˜ íŒ¨í„´"
            chunking: "meso"
          
          - dimension: "ê²½ìŸ êµ¬ì¡°"
            rag_query: "ê²½ìŸ ì—­í•™ íŒ¨í„´"
            chunking: "meso"
          
          # ... 11ê°œ ë”
        
        steve_pattern_recognition:
          - phase: "Phase 2 ë‹¤ì°¨ì› ë¶„ì„"
            rag_query: "Albert 13ê°œ ì°¨ì› â†’ íŒ¨í„´ ë§¤ì¹­"
            graph_query: "ì–´ë–¤ íŒ¨í„´ë“¤ì´ ì¡°í•© ê°€ëŠ¥?"
        
        bill_quantification:
          - phase: "Phase 4 ì •ëŸ‰ ë¶„ì„"
            rag_query: "TAM/SAM/SOM ê³„ì‚° í”„ë ˆì„ì›Œí¬"
            chunking: "calculation"

# ========================================
# Technical Implementation Stack
# @section: tech_stack
# ========================================

technology_stack:
  
  layer_1_vector:
    _status: "implemented"
    
    components:
      - name: "Chroma DB"
        version: "1.3.0"
        role: "ë²¡í„° ì €ì¥ ë° ê²€ìƒ‰"
        cost: "ë¬´ë£Œ (ë¡œì»¬)"
      
      - name: "OpenAI Embeddings"
        model: "text-embedding-3-large"
        dimension: 3072
        cost: "$0.13 / 1M tokens"
      
      - name: "LangChain"
        version: "1.0.3"
        role: "RAG í”„ë ˆì„ì›Œí¬"
  
  layer_2_graph:
    _status: "planned"
    
    components:
      - name: "Neo4j"
        version: "5.x Community"
        role: "ì§€ì‹ ê·¸ë˜í”„"
        cost: "ë¬´ë£Œ"
      
      - name: "py2neo"
        role: "Python driver"
      
      - name: "Cypher"
        role: "ê·¸ë˜í”„ ì¿¼ë¦¬ ì–¸ì–´"
    
    graph_schema:
      nodes: ["Pattern", "Case", "AgentOutput", "Data", "Source"]
      relationships: ["COMBINES_WITH", "COUNTERS", "VERIFIED_BY", "APPROVED_BY", ...]
      indexes:
        - node: "Pattern"
          property: "id"
        - node: "AgentOutput"
          property: "agent"
  
  layer_3_learning:
    _status: "planned"
    
    components:
      - name: "SQLite"
        role: "í”¼ë“œë°± ë° ê°€ì¤‘ì¹˜ ì €ì¥"
        cost: "ë¬´ë£Œ"
      
      - name: "GPT-4"
        role: "ì¿¼ë¦¬ ê°œì„  (Query refinement)"
        cost: "$10 / 1M tokens"
      
      - name: "NumPy"
        role: "ê°€ì¤‘ì¹˜ ê³„ì‚°"
  
  monitoring:
    - name: "LangSmith"
      role: "LLM í˜¸ì¶œ ì¶”ì  (ì„ íƒ)"
      cost: "ë¬´ë£Œ tier ìˆìŒ"
    
    - name: "Loguru"
      role: "ë¡œê¹…"

# ========================================
# Development Roadmap
# @section: roadmap
# ========================================

development_roadmap:
  
  week_1_knowledge_graph:
    goal: "íŒ¨í„´ ê°„ ê´€ê³„ ë° ê²€ì¦ ì²´ì¸ êµ¬í˜„"
    
    day_1:
      - "Neo4j Docker ì„¤ì •"
      - "ê¸°ë³¸ ìŠ¤í‚¤ë§ˆ ì„¤ê³„"
      - "Python driver ì—°ë™ í…ŒìŠ¤íŠ¸"
    
    day_2_3:
      - "íŒ¨í„´ ê´€ê³„ 30ê°œ ì •ì˜ (YAML)"
      - "Graphì— import"
      - "ê´€ê³„ ì¿¼ë¦¬ í…ŒìŠ¤íŠ¸"
    
    day_4_5:
      - "Hybrid ê²€ìƒ‰ ì—”ì§„ êµ¬í˜„"
      - "Vector â†’ Graph í™•ì¥ ê²€ìƒ‰"
      - "ê²°ê³¼ í†µí•© ì•Œê³ ë¦¬ì¦˜"
    
    day_6_7:
      - "Steveì— í†µí•©"
      - "search_hybrid_patterns() êµ¬í˜„"
      - "ì „ì²´ í…ŒìŠ¤íŠ¸"
    
    deliverables:
      - "umis_rag/graph/knowledge_graph.py"
      - "umis_rag/graph/config/pattern_relationships.yaml"
      - "umis_rag/graph/hybrid_retriever.py"
  
  week_2_stewart_meta_rag:
    goal: "ê²€ì¦ ìë™í™” ë° Meta-RAG"
    
    day_1_2:
      - "ê²€ì¦ ê·œì¹™ ì²­í‚¹ (agentë³„)"
      - "validation_rules_index êµ¬ì¶•"
      - "í•„ìˆ˜ ì¡°ê±´ ì²´í¬ ì—”ì§„"
    
    day_3_4:
      - "í’ˆì§ˆ íŒ¨í„´ ìˆ˜ì§‘ (ì¢‹ì€/ë‚˜ìœ ì˜ˆì‹œ)"
      - "quality_patterns_index êµ¬ì¶•"
      - "ìœ ì‚¬ë„ ë¹„êµ ì—”ì§„"
    
    day_5_6:
      - "Graph ê¸°ë°˜ ë…¼ë¦¬ ì²´ì¸ ì¶”ì "
      - "Gap ìë™ ë°œê²¬"
      - "Stewart 3ë‹¨ê³„ ê²€ì¦ í†µí•©"
    
    day_7:
      - "ì „ì²´ í…ŒìŠ¤íŠ¸"
      - "í”¼ë“œë°± ë©”ì‹œì§€ ìƒì„±"
    
    deliverables:
      - "umis_rag/agents/stewart.py"
      - "umis_rag/validation/rules_index.py"
      - "umis_rag/validation/quality_checker.py"
  
  week_3_adaptive_learning:
    goal: "í”¼ë“œë°± í•™ìŠµ ë° ìë™ ê°œì„ "
    
    day_1_2:
      - "Query refinement (LLM)"
      - "í”¼ë“œë°± â†’ ì¿¼ë¦¬ ì¬ì‘ì„±"
      - "ë°˜ë³µ ê²€ìƒ‰ ë¡œì§"
    
    day_3_4:
      - "Weighted retrieval êµ¬í˜„"
      - "ê°€ì¤‘ì¹˜ ì—…ë°ì´íŠ¸ ë¡œì§"
      - "SQLite ì €ì¥"
    
    day_5:
      - "ê°•í™”í•™ìŠµ (ì„ íƒ)"
      - "Multi-Armed Bandits"
      - "íŒ¨í„´ ì„ íƒ ìµœì í™”"
    
    day_6_7:
      - "ì „ì²´ í†µí•© í…ŒìŠ¤íŠ¸"
      - "ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬"
      - "ë¬¸ì„œí™”"
    
    deliverables:
      - "umis_rag/adaptive/query_refiner.py"
      - "umis_rag/adaptive/weighted_retriever.py"
      - "umis_rag/adaptive/feedback_db.py"

# ========================================
# Performance & Quality Metrics
# @section: metrics
# ========================================

success_metrics:
  
  retrieval_quality:
    metric_1:
      name: "íŒ¨í„´ ë§¤ì¹­ ì •í™•ë„"
      target: "> 90%"
      measurement: "Albert íŠ¸ë¦¬ê±° â†’ ì˜¬ë°”ë¥¸ íŒ¨í„´ Top-3ì— í¬í•¨"
    
    metric_2:
      name: "ì‚¬ë¡€ ê´€ë ¨ì„±"
      target: "> 85%"
      measurement: "ì‚°ì—… ìœ ì‚¬ ì‚¬ë¡€ Top-5 í‰ê·  ìœ ì‚¬ë„"
    
    metric_3:
      name: "ê²€ì¦ ì²´ì¸ ì™„ê²°ì„±"
      target: "100%"
      measurement: "Graphì—ì„œ Sourceê¹Œì§€ ì¶”ì  ê°€ëŠ¥"
  
  validation_automation:
    metric_1:
      name: "Stewart ìë™ ê²€ì¦ ì •í™•ë„"
      target: "> 95%"
      measurement: "Stewart íŒë‹¨ vs ì‚¬ëŒ íŒë‹¨ ì¼ì¹˜ìœ¨"
    
    metric_2:
      name: "Gap ë°œê²¬ìœ¨"
      target: "100%"
      measurement: "ëˆ„ë½ëœ ê²€ì¦ ìë™ ë°œê²¬"
  
  learning_effectiveness:
    metric_1:
      name: "ë°˜ë³µ ì‹œ í’ˆì§ˆ í–¥ìƒ"
      target: "iterationë³„ +1 grade"
      measurement: "D â†’ C â†’ B â†’ A ì§„í–‰ë¥ "
    
    metric_2:
      name: "ì¿¼ë¦¬ íš¨ìœ¨ ê°œì„ "
      target: "50% ê°ì†Œ"
      measurement: "ìŠ¹ì¸ê¹Œì§€ í‰ê·  ì¿¼ë¦¬ ìˆ˜"
  
  system_performance:
    latency:
      vector_search: "< 100ms"
      graph_query: "< 200ms"
      hybrid_search: "< 300ms"
      llm_refinement: "< 2s"
    
    cost:
      daily_usage:
        embeddings: "< $0.01"
        llm_calls: "< $0.50"
        total: "< $0.51 / day"
      
      monthly: "< $15"

# ========================================
# Critical Design Decisions
# @section: design_decisions
# ========================================

critical_design_decisions:
  
  decision_1_storage_model:
    question: "Single collection vs Multi-collection?"
    
    chosen: "Single collection (umis_knowledge_base)"
    
    rationale:
      - "Single Source of Truth"
      - "Cross-agent í˜‘ì—… ìš©ì´"
      - "ë©”íƒ€ë°ì´í„° ì¼ê´€ì„±"
      - "source_idë¡œ ì—°ê²°"
    
    alternative_rejected: "Agentë³„ ë³„ë„ collection"
    rejection_reason: "ì¤‘ë³µ, ì¼ê´€ì„± ë¬¸ì œ, í˜‘ì—… ë³µì¡"
  
  decision_2_chunking_strategy:
    question: "Agentë³„ ì²­í‚¹ vs ë‹¨ì¼ ì²­í‚¹?"
    
    chosen: "Agentë³„ ì ì‘í˜• ì²­í‚¹"
    
    rationale:
      - "ê°™ì€ ë°ì´í„°, ë‹¤ë¥¸ ê´€ì "
      - "Steve: case (ì™„ê²°ì„±), Bill: calculation (ì¬ì‚¬ìš©)"
      - "ê° agentì˜ ì •ë³´ ìš”êµ¬ íŠ¹ì„± ë°˜ì˜"
    
    alternative_rejected: "ê³ ì • í¬ê¸° ì²­í‚¹ (500 í† í°)"
    rejection_reason: "agent íŠ¹ì„± ë¬´ì‹œ, ë¹„íš¨ìœ¨"
  
  decision_3_embeddings_model:
    question: "small (ì €ë ´) vs large (ê³ í’ˆì§ˆ)?"
    
    chosen: "text-embedding-3-large"
    
    rationale:
      - "í–¥í›„ ëŒ€ìš©ëŸ‰ ë¹„ì •í˜• ë°ì´í„°"
      - "ë¯¸ë¬˜í•œ ë¬¸ë§¥ ì°¨ì´ critical"
      - "ë¹„ìš© ì°¨ì´ ë¯¸ë¯¸ ($10/ë…„)"
      - "UMIS = ì „ë¬¸ê°€ ì‹œìŠ¤í…œ, í’ˆì§ˆ ìš°ì„ "
    
    alternative_rejected: "text-embedding-3-small"
    rejection_reason: "ë‹¨ê¸° ë¹„ìš© ì ˆê° < ì¥ê¸° í’ˆì§ˆ"
  
  decision_4_graph_necessity:
    question: "Vectorë§Œ vs Vector + Graph?"
    
    chosen: "Vector + Graph Hybrid"
    
    rationale:
      - "íŒ¨í„´ ì¡°í•© ê´€ê³„ í‘œí˜„ í•„ìˆ˜"
      - "ê²€ì¦ ì²´ì¸ ì¶”ì  í•„ìˆ˜ (Stewart)"
      - "UMIS í”¼ë“œë°± ë£¨í”„ êµ¬í˜„ í•„ìˆ˜"
      - "Vector ë‹¨ë…ìœ¼ë¡œëŠ” ë¶ˆê°€ëŠ¥"
    
    alternative_rejected: "Vector RAG only"
    rejection_reason: "UMIS ë³¸ì§ˆ êµ¬í˜„ ë¶ˆê°€"
  
  decision_5_stewart_architecture:
    question: "ì¼ë°˜ RAG vs Meta-RAG?"
    
    chosen: "Meta-RAG (3ê°œ ì „ìš© ì¸ë±ìŠ¤ + Graph)"
    
    rationale:
      - "Stewart = ë‹¤ë¥¸ agent í‰ê°€ ì—­í• "
      - "ì¼ë°˜ RAGë¡œëŠ” ê²€ì¦ ë¶ˆê°€ëŠ¥"
      - "Graphë¡œ ë…¼ë¦¬ ì²´ì¸ ì¶”ì  í•„ìˆ˜"
    
    alternative_rejected: "ë‹¨ì¼ RAG"
    rejection_reason: "ì—­í•  êµ¬í˜„ ë¶ˆê°€ëŠ¥"
  
  decision_6_learning_approach:
    question: "ì •ì  vs í•™ìŠµí˜•?"
    
    chosen: "Adaptive Learning (í”¼ë“œë°± ë°˜ì˜)"
    
    rationale:
      - "UMISëŠ” í”¼ë“œë°± ë£¨í”„ í•µì‹¬"
      - "ì ì§„ì  ì§€ëŠ¥ ì‹œìŠ¤í…œ"
      - "ì‚¬ìš©í• ìˆ˜ë¡ í–¥ìƒ"
    
    alternative_rejected: "ì •ì  RAG"
    rejection_reason: "UMIS ì² í•™ê³¼ ìƒì¶©"

# ========================================
# UMIS-Specific Enhancements
# @section: umis_enhancements
# ========================================

umis_specific_features:
  _description: "UMISì˜ ê³ ìœ  íŠ¹ì„±ì„ ë°˜ì˜í•œ RAG ê¸°ëŠ¥"
  
  feature_1_deliverable_standards:
    _umis_reference: "umis_deliverable_standards_v6.2.yaml"
    
    implementation:
      rachel_source_registry:
        rag_integration: |
          Rachelì´ source_registry.yaml ìƒì„± ì‹œ
          RAGì—ì„œ ëª¨ë“  SRC_ID ìë™ ì¶”ì 
          
          Graph ì¿¼ë¦¬:
            MATCH (data:Data)-[:SOURCED_FROM]->(src:Source)
            RETURN DISTINCT src.id, src.type, src.url
          
          â†’ source_registry.yaml ìë™ ìƒì„±!
      
      bill_estimation_details:
        rag_integration: |
          Billì˜ ì¶”ì •ì¹˜ë§ˆë‹¤ EST_ID ë¶€ì—¬
          RAG/Graphì—ì„œ ì¶”ì • ë…¼ë¦¬ ì €ì¥
          
          ê²€ìƒ‰ ê°€ëŠ¥:
            "EST_001ì˜ ì¶”ì • ë…¼ë¦¬ëŠ”?"
            â†’ 7ê°œ ì„¹ì…˜ ë°˜í™˜
      
      steve_opportunity_traceability:
        rag_integration: |
          Steve ê°€ì„¤ì˜ ê·¼ê±° ì²´ì¸ ì™„ì „ ì¶”ì 
          
          Graph:
            OPP_001 (ê°€ì„¤)
              â†’ Albert ê´€ì°°
              â†’ Bill SAM ê³„ì‚°
              â†’ Rachel SRC_005
              â†’ ì •ë¶€ í†µê³„
          
          â†’ ì™„ì „í•œ Traceability!
  
  feature_2_call_sign_system:
    _umis_reference: "Call Sign System (v6.2)"
    
    implementation:
      project_lifecycle:
        start_signal: "[PROJECT_START]"
        
        rag_action:
          - create: "í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸ ë…¸ë“œ (Graph)"
          - initialize: "í”„ë¡œì íŠ¸ë³„ ì»¬ë ‰ì…˜ (optional)"
          - track: "í”„ë¡œì íŠ¸ ì§„í–‰ ìƒíƒœ"
        
        end_signal: "[PROJECT_END]"
        
        rag_action:
          - archive: "í”„ë¡œì íŠ¸ ì»¬ë ‰ì…˜ snapshot"
          - index: "ì™„ë£Œ í”„ë¡œì íŠ¸ ê²€ìƒ‰ ê°€ëŠ¥í•˜ê²Œ"
          - learn: "ì„±ê³µ/ì‹¤íŒ¨ íŒ¨í„´ í•™ìŠµ"
  
  feature_3_guesstimation_transparency:
    _umis_reference: "Bill Estimation_Details 7ê°œ ì„¹ì…˜"
    
    implementation:
      estimation_tracking:
        when_bill_estimates:
          - action: "EST_ID ìë™ ìƒì„±"
          - create_chunk: 
              content: |
                [EST_001] í”¼ì•„ë…¸ í•™ì› ë¹„ì¤‘ 30% ì¶”ì •
                
                [1] ì¶”ì • í•„ìš” ì´ìœ : ê³µì‹ í†µê³„ ì—†ìŒ
                [2] ì‚¬ìš© ë°ì´í„°: ì•…ê¸° í•™ì› ì „ì²´ (SRC_010)
                [3] ì¶”ì • ë…¼ë¦¬: 
                    - ì „ì²´ ì•…ê¸° í•™ì›: 5,000ê°œ
                    - í”¼ì•„ë…¸ ê´€ë ¨ ê²€ìƒ‰ëŸ‰ 30%
                    - í•™ì› ê°„ ê·œëª¨ ìœ ì‚¬ ê°€ì •
                [4] ì‹ ë¢°ë„: Medium (ê°„ì ‘ ì¶”ì •)
                [5] ê²€ì¦ ë°©ë²•: ì—…ê³„ ì¸í„°ë·°
                [6] ëŒ€ì²´ ì ‘ê·¼: ì‹œë„í–ˆìœ¼ë‚˜ ë°ì´í„° ë¶€ì¡±
                [7] ì‚¬ìš© ìœ„ì¹˜: TAM ê³„ì‚°ì— ì‚¬ìš©
              
              metadata:
                est_id: "EST_001"
                reliability: "medium"
                bill_chunking_level: "calculation"
          
          - graph_link:
              create: "(BillCalculation)-[:USES_ESTIMATION]->(EST_001)"
              track: "ì–´ë–¤ ê³„ì‚°ì— ì–´ë–¤ ì¶”ì • ì‚¬ìš©í–ˆë‚˜"
  
  feature_4_checkpoint_integration:
    _umis_reference: "4ê°œ í•„ìˆ˜ ê²€ì¦ ì²´í¬í¬ì¸íŠ¸"
    
    implementation:
      checkpoint_as_graph_milestone:
        - checkpoint: "CP1_Albert_êµ¬ì¡°ë¶„ì„"
          graph_check: |
            MATCH (a:AlbertObservation)
                  -[:VERIFIED_BY]->(r:RachelVerification)
            WHERE a.project_id = $project_id
            RETURN count(r) as verification_count
          
          pass_criteria: "verification_count > 0"
        
        - checkpoint: "CP2_Steve_ê°€ì„¤ìƒì„±"
          graph_check: |
            MATCH (s:SteveHypothesis)
                  -[:BASED_ON]->(a:AlbertObservation),
                  (s)-[:REQUIRES_VALIDATION]->(b:BillCalculation)
                  -[:SOURCED_FROM]->(src:Source)
                  -[:VERIFIED_BY]->(r:RachelVerification)
            RETURN count(*) as complete_chain
          
          pass_criteria: "complete_chain > 0"
        
        - checkpoint: "CP3_Bill_SAMê³„ì‚°"
          graph_check: |
            MATCH (b:BillCalculation)
                  -[:SOURCED_FROM*1..3]->(src:Source)
                  -[:VERIFIED_BY]->(r:RachelVerification)
            WHERE b.calc_type = 'SAM'
            RETURN count(DISTINCT src) as verified_sources
          
          pass_criteria: "verified_sources >= 2"
        
        - checkpoint: "CP4_Owner_ìµœì¢…ê²°ì •"
          graph_check: |
            MATCH path = (o:OwnerDecision)
                         -[:BASED_ON*1..20]->(src:Source)
            WHERE ALL(n in nodes(path) WHERE n.validated = true)
            RETURN length(path) as chain_depth
          
          pass_criteria: "chain_depth > 0 AND all_validated"

# ========================================
# END OF ARCHITECTURE SPEC
# ========================================

