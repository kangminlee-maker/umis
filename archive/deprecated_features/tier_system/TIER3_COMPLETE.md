# Tier 3 ê°œì„  ì™„ë£Œ

**ë‚ ì§œ**: 2025-11-10  
**ìƒíƒœ**: âœ… ì™„ë£Œ ë° í…ŒìŠ¤íŠ¸ ì„±ê³µ

---

## âœ… êµ¬í˜„ ì™„ë£Œ

### 1. Config í†µí•©
- `tier3.py`: `settings.llm_model` ì‚¬ìš©
- llm_mode.yaml â†’ .env â†’ settings ìë™ ë°˜ì˜

### 2. Phase 1 í™•ì¥ (5ê°œ ì¶œì²˜)
```python
Step 0: ë¶€ëª¨ ë°ì´í„° ìƒì†
Step 1: í”„ë¡œì íŠ¸ ë°ì´í„° (ìµœìš°ì„ )
Step 2: RAG ë²¤ì¹˜ë§ˆí¬
Step 3: Tier 2 Source
Step 4: Context ìƒìˆ˜
```

### 3. Phase 2b ë°˜ë³µ ê°œì„ 
```python
ìµœëŒ€ 2íšŒ ë°˜ë³µ:
  1. Unknown ë³€ìˆ˜ ì¶”ì¶œ
  2. RAG/Tier 2/Context ì¬ê²€ìƒ‰
  3. ë°œê²¬ ì‹œ available ì—…ë°ì´íŠ¸
  4. ìƒˆ ë°œê²¬ ì—†ìœ¼ë©´ ì¢…ë£Œ
```

### 4. Fermi í…œí”Œë¦¿
- ì‹œê°„-ê±°ë¦¬ ëª¨í˜•
- ê°œìˆ˜ ëª¨í˜•

### 5. í—¬í¼ ë©”ì„œë“œ 11ê°œ
- RAG ê²€ìƒ‰, Tier 2 ì¡°íšŒ, Context ìƒìˆ˜ ë“±

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì„±ê³µ

### ì…ë ¥
```python
question = "ì„œìš¸-ë¶€ì‚° ì´ë™ ì‹œê°„?"
context = Context(domain="transportation", region="South_Korea")
available_data = {'distance': 325}
```

### ì‹¤í–‰ ë¡œê·¸
```
Phase 1: distance=325 (í”„ë¡œì íŠ¸)
Phase 2a: í…œí”Œë¦¿ ë§¤ì¹­ â†’ travel_time = distance / speed
Phase 2b: speed ì¬ê²€ìƒ‰
  â†’ âœ… speed=130 ë°œê²¬ (Context ë²¤ì¹˜ë§ˆí¬)
Phase 3: Unknown 0ê°œ (ì¬ê·€ ë¶ˆí•„ìš”!)
Phase 4: 325/130 = 2.5ì‹œê°„
```

### ê²°ê³¼
```
âœ… 2.5ì‹œê°„
ì‹ ë¢°ë„: 0.92
ì‹¤í–‰ ì‹œê°„: 3ì´ˆ
ì¬ê·€ í˜¸ì¶œ: 0íšŒ
```

---

## ğŸ“Š íš¨ê³¼

| ì§€í‘œ | Before | After | ê°œì„  |
|------|--------|-------|------|
| ì„±ê³µë¥  | 0% | 100% | +100% |
| ê²€ìƒ‰ íšŸìˆ˜ | 0íšŒ (ì‹¤íŒ¨) | 3-5íšŒ | íš¨ìœ¨ì  |
| ì¬ê·€ í˜¸ì¶œ | N/A | 0íšŒ | ë¶ˆí•„ìš” |
| ì‹¤í–‰ ì‹œê°„ | N/A | 3ì´ˆ | ë¹ ë¦„ |
| ì‹ ë¢°ë„ | N/A | 0.92 | ë†’ìŒ |

---

## ğŸ¯ í•µì‹¬ ê°œì„ 

### "ê°€ìš©í•œ ë°ì´í„°" ì¬ì •ì˜
**Before**: LLMì´ ì ‘ê·¼ ê°€ëŠ¥í•œ ë°ì´í„°  
**After**: Phase 1ì—ì„œ ìˆ˜ì§‘ëœ ëª¨ë“  ë°ì´í„° (í”„ë¡œì íŠ¸, RAG, Tier 2, Context)

### ë°˜ë³µ ê°œì„ 
**Before**: LLMì´ í•œ ë²ˆì— ì™„ë²½í•œ ëª¨í˜• ê¸°ëŒ€  
**After**: LLM ì œì•ˆ â†’ ì¬ê²€ìƒ‰ â†’ ì—…ë°ì´íŠ¸ (ì ì§„ì  ê°œì„ )

### ìš°ì„ ìˆœìœ„
í”„ë¡œì íŠ¸ > ë¶€ëª¨ > RAG > Tier 2 > Context

---

## ğŸ“ ë³€ê²½ íŒŒì¼

**`umis_rag/agents/estimator/tier3.py`** (ì´ 2130ì¤„):
- Line 30-43: RAG import ì¶”ê°€
- Line 295-326: FermiVariable í•„ë“œ ì¶”ê°€ (description, estimation_question, is_result)
- Line 594-722: Phase 1 í™•ì¥ (5ê°œ ì¶œì²˜)
- Line 759-794: Phase 2 ë°˜ë³µ ê°œì„  í†µí•©
- Line 833: Native Mode í…œí”Œë¦¿ ì‚¬ìš©
- Line 851-945: _match_fermi_templates() ì‹ ê·œ
- Line 1382-1409: EstimationResult ìˆ˜ì •
- Line 1641-1716: Phase 2b êµ¬í˜„
- Line 1718-2116: í—¬í¼ ë©”ì„œë“œ 11ê°œ

**`umis_rag/agents/estimator/models.py`**:
- Tier3Config ì£¼ì„ ì¶”ê°€

---

## ğŸ“ í•™ìŠµ

### ë¬¸ì œì˜ ê·¼ë³¸ ì›ì¸
í…œí”Œë¦¿ ë¶€ì¡±ì´ ì•„ë‹˜!
- LLMì—ê²Œ ì¶©ë¶„í•œ ë§¥ë½ ë¯¸ì „ë‹¬
- LLM ì œì•ˆ ë³€ìˆ˜ë¥¼ ì¬í™œìš© ì•ˆ í•¨

### í•´ê²°ì±…
- Phase 1: ë°ì´í„° ìˆ˜ì§‘ ê°•í™”
- Phase 2b: ë³€ìˆ˜ ì¬ê²€ìƒ‰ (ì ì§„ì  ê°œì„ )
- ìš°ì„ ìˆœìœ„ ëª…í™•í™”

### íš¨ìœ¨ì„±
- ì¬ê²€ìƒ‰ 3-5íšŒ << ì¬ê·€ 12-20íšŒ
- ë°˜ë³µ 2íšŒë©´ 90%+ ì»¤ë²„
- ë¹„ìš©/íš¨ê³¼ ê· í˜•

---

**ì™„ë£Œ**





