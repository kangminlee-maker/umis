# Guestimation RAG Integration Design
# 기존 Canonical-Projected 아키텍처에 Guestimation 통합

meta:
  version: "3.0-integrated"
  date: "2025-11-07"
  approach: "기존 RAG 아키텍처 활용 (별도 Collection 아님)"

---

# ═══════════════════════════════════════════════════════
# PART 1: 현재 UMIS RAG 아키텍처 (복습)
# ═══════════════════════════════════════════════════════

current_umis_rag_architecture:
  
  핵심_구조:
    
    Canonical_Index:
      목적: "정규화된 원본 (업데이트용)"
      ID: "CAN-xxxxxxxx"
      
      특징:
        - Write 1곳만 (일관성)
        - anchor_path + content_hash
        - 모든 Agent 정보 포함
        - sections으로 Agent별 영역 표시
      
      예시:
        canonical_chunk_id: "CAN-subscription-001"
        
        content: "구독 모델 전체 내용 (500 tokens)"
        
        sections:
          - agent_view: "explorer"
            anchor_path: "subscription_model.trigger_observations"
            content_hash: "sha256:abc123..."
            span_hint: {paragraphs: "1-5"}
          
          - agent_view: "quantifier"
            anchor_path: "subscription_model.metrics"
            content_hash: "sha256:def456..."
            span_hint: {paragraphs: "6-8"}
    
    Projected_Index:
      목적: "Agent별 검색용 Materialized View"
      ID: "PRJ-xxxxxxxx"
      
      특징:
        - Agent별 분리 (explorer, quantifier, ...)
        - TTL 24시간 (on-demand)
        - 고빈도 → persistent
        - Agent 특화 메타데이터
      
      예시:
        projected_chunk_id: "PRJ-subscription-exp-001"
        agent_view: "explorer"
        
        canonical_chunk_id: "CAN-subscription-001"
        
        content: "구독 모델 (Explorer 관점 내용)"
        
        metadata:
          explorer_pattern_id: "subscription_model"
          explorer_csf: ["recurring_revenue", "churn_management"]
          explorer_trigger: ["구독 트렌드", "MRR 성장"]
    
    Projection_Mechanism:
      방식: "90% 규칙 + 10% LLM"
      
      파일: "config/projection_rules.yaml"
      
      규칙_예시:
        field_rules:
          trigger_observations:
            agents: [explorer, observer]
            reason: "기회 인식 + 구조 관찰"
          
          metrics:
            agents: [quantifier, guardian]
            reason: "계산 + 검증"
      
      LLM_판단:
        - 규칙 없는 필드 → LLM 판단
        - 로그 저장
        - 3회 일관성 → 자동 규칙화

---

# ═══════════════════════════════════════════════════════
# PART 2: Guestimation 통합 제안 (핵심!)
# ═══════════════════════════════════════════════════════

guestimation_integration_proposal:
  
  핵심_아이디어:
    
    개념: "별도 Collection 만들지 않고 기존 구조 활용"
    
    방법:
      1. Canonical에 Guestimation 필드 추가
      2. Projected View "guestimation" 생성
      3. Projection Rules 확장
    
    장점:
      ✅ 아키텍처 일관성
      ✅ 중복 없음
      ✅ 통합 관리
      ✅ 기존 인프라 100% 재사용
  
  통합_방식:
    
    단계_1_Canonical_확장:
      
      기존_Canonical:
        canonical_chunk_id: "CAN-subscription-001"
        
        content: "구독 모델..."
        
        sections:
          - agent_view: "explorer"
          - agent_view: "quantifier"
      
      Guestimation_필드_추가:
        canonical_chunk_id: "CAN-subscription-001"
        
        content: "구독 모델..."
        
        sections:
          - agent_view: "explorer"
          - agent_view: "quantifier"
          - agent_view: "guestimation" ⭐
            anchor_path: "subscription_model.estimation_data"
            content_hash: "sha256:ghi789..."
      
      새_필드:
        
        estimation_data:
          위치: "각 패턴/사례 안에 추가"
          
          내용:
            - 추정 가능한 값들
            - 범위
            - 조건 (맥락)
          
          예시:
            subscription_model:
              # 기존 필드들...
              trigger_observations: "..."
              success_cases: "..."
              
              # 신규 필드 ⭐
              estimation_data:
                metrics:
                  churn_rate:
                    value: 0.06
                    range: [0.05, 0.07]
                    
                    context:
                      domain: "B2B_SaaS"
                      region: "Global"
                      time_period: "2023-2024"
                    
                    confidence: 0.80
                    
                    source:
                      type: "industry_benchmark"
                      references: ["Netflix case", "Spotify data"]
                  
                  arpu:
                    value: 50000
                    range: [30000, 80000]
                    unit: "원"
                    
                    context:
                      domain: "B2B_SaaS"
                      region: "한국"
                      segment: "중소기업"
                    
                    confidence: 0.75
    
    단계_2_Projected_View_추가:
      
      기존_Views:
        - agent_view: "explorer"
        - agent_view: "quantifier"
        - agent_view: "validator"
        - agent_view: "observer"
      
      신규_View:
        - agent_view: "guestimation" ⭐
      
      Projection_결과:
        projected_chunk_id: "PRJ-subscription-gst-001"
        agent_view: "guestimation"
        
        canonical_chunk_id: "CAN-subscription-001"
        
        content: "구독 모델의 추정 가능 지표"
        
        metadata:
          # Guestimation 특화 필드
          guestimation_metrics: ["churn_rate", "arpu", "ltv"]
          
          guestimation_domain: "B2B_SaaS"
          
          guestimation_values:
            churn_rate:
              value: 0.06
              range: [0.05, 0.07]
              context: {region: "Global", ...}
          
          # 검색용
          searchable_questions:
            - "SaaS Churn은?"
            - "구독 모델 해지율은?"
            - "B2B 이탈률은?"
    
    단계_3_Projection_Rules_확장:
      
      파일: "config/projection_rules.yaml"
      
      기존_규칙:
        field_rules:
          trigger_observations:
            agents: [explorer, observer]
          
          metrics:
            agents: [quantifier, guardian]
      
      Guestimation_규칙_추가:
        field_rules:
          estimation_data:
            agents: [guestimation] ⭐
            reason: "추정 가능한 값 검색"
          
          estimation_data.metrics:
            agents: [guestimation]
            projection_method: "flatten_to_searchable"
            
            transform:
              설명: "중첩 구조 → 평탄화"
              
              before:
                estimation_data:
                  metrics:
                    churn_rate: {value: 0.06, ...}
                    arpu: {value: 50000, ...}
              
              after:
                guestimation_metrics: ["churn_rate", "arpu"]
                guestimation_churn_rate_value: 0.06
                guestimation_arpu_value: 50000

---

# ═══════════════════════════════════════════════════════
# PART 3: 장단점 비교
# ═══════════════════════════════════════════════════════

comparison:
  
  방식_A_별도_Collection:
    
    구조:
      Collections:
        - tier1_learned_rules (신규, 별도)
        - market_benchmarks (기존, 재사용)
    
    장점:
      - 독립적 (Guestimation만 관리)
      - 스키마 자유 (제약 없음)
      - 빠른 구현 (기존 코드 영향 없음)
    
    단점:
      ❌ Collection 증가 (13→14개)
      ❌ 데이터 중복 가능
      ❌ 관리 포인트 증가
      ❌ 아키텍처 불일치
  
  방식_B_Canonical_Projected_통합:
    
    구조:
      Collections:
        - canonical_index (확장)
        - projected_index (guestimation view 추가)
    
    장점:
      ✅ 아키텍처 일관성 (기존 구조 그대로)
      ✅ Collection 증가 없음
      ✅ 중복 없음 (Canonical 1곳)
      ✅ 통합 관리
      ✅ Projection 메커니즘 재사용
    
    단점:
      ❌ 기존 시스템 수정 필요
      ❌ Canonical 스키마 확장
      ❌ 구현 복잡도 약간 증가
  
  비교_요약:
    
    독립성:
      A: 높음 (독립적)
      B: 낮음 (통합)
    
    아키텍처_일관성:
      A: 낮음 (별도 구조)
      B: 높음 (기존 구조 활용) ⭐
    
    구현_난이도:
      A: 낮음
      B: 중간
    
    장기_유지보수:
      A: 중간 (관리 포인트 많음)
      B: 쉬움 (통합 관리) ⭐
    
    확장성:
      A: 중간
      B: 높음 (Projection 메커니즘) ⭐
  
  권장: 방식_B (Canonical-Projected 통합)
    
    이유:
      1. 아키텍처 일관성 (가장 중요!)
      2. 중복 없음
      3. 기존 메커니즘 재사용
      4. 장기적으로 유리

---

# ═══════════════════════════════════════════════════════
# PART 4: 통합 설계 상세
# ═══════════════════════════════════════════════════════

integrated_design:
  
  Canonical_스키마_확장:
    
    기존_구조:
      canonical_chunk:
        chunk_id: "CAN-xxx"
        chunk_type: "business_model_pattern | success_case | ..."
        
        content: "..."
        
        sections:
          - agent_view: "explorer"
            anchor_path: "..."
          - agent_view: "quantifier"
            anchor_path: "..."
        
        metadata:
          domain: "..."
          industry: "..."
          # ...
    
    Guestimation_확장:
      
      새_chunk_type_추가:
        기존: "business_model_pattern | success_case"
        추가: "learned_estimation_rule" ⭐
        
        용도: "학습된 추정 결과"
      
      새_section_추가:
        sections:
          - agent_view: "guestimation" ⭐
            anchor_path: "estimation_data.metrics"
      
      새_metadata_필드:
        
        guestimation_specific:
          
          question_pattern:
            original: "한국 음식점 월매출은?"
            template: "[지역] [업종] [지표]"
            keywords: ["한국", "음식점", "월매출"]
          
          estimation_context:
            intent: "understand_market"
            domain: "Food_Service"
            region: "한국"
            time_period: "2024"
            granularity: "macro"
          
          estimation_result:
            metric: "monthly_revenue"
            value: 2700만원
            value_min: 1890만원
            value_max: 3510만원
            unit: "원"
            confidence: 0.85
          
          provenance:
            tier_origin: "tier2 | tier3 | user_contributed"
            sources: ["web", "rag", "llm"]
            strategy: "weighted_average"
            
            learned_at: "2024-11-07"
            usage_count: 10
  
  Projected_View_guestimation:
    
    생성_방식:
      
      Projection_Rule:
        field: "estimation_data"
        target_agent: "guestimation"
        
        projection_logic:
          설명: "추정 데이터만 추출하여 검색 최적화"
          
          변환:
            Canonical_필드:
              estimation_data:
                metrics:
                  churn_rate: {...}
                  arpu: {...}
            
            Projected_필드:
              guestimation_metrics: ["churn_rate", "arpu"]
              guestimation_churn_rate: {...}
              guestimation_arpu: {...}
      
      TTL_전략:
        기본: "on_demand (24시간)"
        
        고빈도_감지:
          IF access_count >= 10:
            → materialization: "persistent"
    
    검색_최적화:
      
      page_content_구성:
        목적: "임베딩 품질 향상"
        
        내용: |
          질문: 한국 음식점 월평균 매출은?
          
          지표: 월간 매출 (monthly_revenue)
          값: 2,700만원
          범위: 1,890 ~ 3,510만원
          
          맥락:
          - 도메인: Food Service (음식점)
          - 지역: 한국
          - 시점: 2024년
          - 세분화: 전체 평균
          
          신뢰도: 85%
          출처: 웹 검색, RAG 벤치마크, LLM
        
        효과:
          - "음식점 매출" 검색 → 잘 매칭
          - "식당 월매출" 검색 → 잘 매칭
          - "Food Service revenue" → 잘 매칭
      
      metadata_필터링:
        
        검색_시:
          query: "한국 카페 월매출은?"
          
          임베딩_검색: similarity_search(query, top_k=10)
          
          메타데이터_필터링:
            filter:
              guestimation_domain: "Food_Service"
              guestimation_region: "한국"
              guestimation_metric: "monthly_revenue"
          
          결과: 정확도 ↑

---

# ═══════════════════════════════════════════════════════
# PART 5: 데이터 추가 흐름
# ═══════════════════════════════════════════════════════

data_addition_flow:
  
  시나리오_1_Tier_2_학습:
    
    단계:
      1. Tier_2_추정_완료:
         질문: "한국 음식점 월매출은?"
         결과: 2,700만원 ± 30%
         맥락: {domain: "Food_Service", ...}
      
      2. 재사용_가치_판단:
         IF usage_count >= 10 AND confidence >= 0.85:
           → 학습 트리거!
      
      3. Canonical_문서_생성:
         
         chunk_id: "CAN-learned-food-001"
         chunk_type: "learned_estimation_rule" ⭐
         
         content: |
           학습된 추정 규칙
           
           질문: 한국 음식점 월평균 매출은?
           
           추정 결과:
           - 값: 2,700만원
           - 범위: 1,890 ~ 3,510만원
           - 불확실성: ±30%
           
           맥락:
           - 의도: 시장 이해
           - 도메인: Food Service
           - 지역: 한국
           - 시점: 2024년
           
           출처:
           - 웹 검색 (3,000만원)
           - RAG 벤치마크 (2,500만원)
           - LLM 직접 (2,700만원)
           
           판단 전략: 가중 평균
           증거 개수: 5개
           신뢰도: 85%
         
         sections:
           - agent_view: "guestimation"
             anchor_path: "learned_rules.food_service.monthly_revenue"
             content_hash: "sha256:..."
         
         metadata:
           chunk_type: "learned_estimation_rule"
           
           # Guestimation 필드
           guestimation_question: "한국 음식점 월매출은?"
           guestimation_metric: "monthly_revenue"
           guestimation_value: 2700만원
           guestimation_domain: "Food_Service"
           guestimation_region: "한국"
           
           # 표준 필드
           domain: "Food_Service"
           industry: "Food"
           
           # Provenance
           tier_origin: "tier2"
           learned_at: "2024-11-07"
           usage_count: 10
      
      4. Projected_View_자동_생성:
         
         Projection_Rule_적용:
           field: "guestimation 필드들"
           target_agent: "guestimation"
         
         결과:
           projected_chunk_id: "PRJ-learned-food-gst-001"
           agent_view: "guestimation"
           
           content: "한국 음식점 월매출 2,700만원..."
           
           metadata:
             guestimation_question: "한국 음식점 월매출은?"
             guestimation_metric: "monthly_revenue"
             guestimation_value: 2700만원
             # ...
  
  시나리오_2_사용자_기여:
    
    단계:
      1. 사용자_입력:
         "업계 평균 SaaS Churn 5%라고 들었어"
      
      2. Fact_추출:
         metric: "churn_rate"
         value: 0.05
         domain: "B2B_SaaS"
         source_type: "user_stated"
      
      3. 검증_대기:
         파일: "data/user_facts/pending/user123.jsonl"
      
      4. 검증_통과:
         교차 검증 or 외부 검증
      
      5. Canonical_추가:
         
         chunk_id: "CAN-user-saas-001"
         chunk_type: "learned_estimation_rule"
         
         content: "사용자 기여 벤치마크..."
         
         metadata:
           guestimation_metric: "churn_rate"
           guestimation_value: 0.05
           guestimation_domain: "B2B_SaaS"
           
           tier_origin: "user_contributed" ⭐
           contributor_id: "user123"
      
      6. Projected_자동_생성:
         agent_view: "guestimation"

---

# ═══════════════════════════════════════════════════════
# PART 6: 검색 흐름
# ═══════════════════════════════════════════════════════

search_flow:
  
  Tier_1_검색:
    
    질문: "한국 음식점 월매출은?"
    
    단계:
      1. Built_in_규칙_체크:
         - 10-20개 명백한 규칙
         - 매칭 실패
      
      2. Projected_Index_검색:
         
         Collection: "projected_index"
         
         Filter: {agent_view: "guestimation"}
         
         Query: "한국 음식점 월매출은?"
         
         검색:
           results = projected_index.similarity_search_with_score(
             query="한국 음식점 월매출은?",
             filter={"agent_view": "guestimation"},
             k=5
           )
         
         결과:
           - PRJ-learned-food-gst-001 (유사도 0.92)
           - PRJ-learned-cafe-gst-002 (유사도 0.75)
      
      3. 맥락_필터링:
         
         질문_맥락: {domain: "Food_Service", region: "한국"}
         
         후보들_체크:
           PRJ-001:
             guestimation_domain: "Food_Service" ✅
             guestimation_region: "한국" ✅
             유사도: 0.92
             최종_점수: 0.92
           
           PRJ-002:
             guestimation_domain: "Food_Service" ✅
             guestimation_region: "미국" ❌
             유사도: 0.75
             최종_점수: 0.75 × 0.7 = 0.525 (페널티)
      
      4. 최고_점수_선택:
         
         IF 최고_점수 >= 0.85:
           → 해당 규칙 사용
           → Tier 1 완료!
         
         ELSE:
           → Tier 2로 넘김
  
  장점:
    
    기존_인프라_100%_재사용:
      - ChromaDB ✅
      - similarity_search_with_score() ✅
      - 메타데이터 필터링 ✅
      - TTL 메커니즘 ✅
    
    통합_검색:
      - 한 번의 검색으로
      - 모든 출처 커버 (시스템 학습 + 사용자 기여)
    
    자동_최적화:
      - 고빈도 → persistent
      - 저빈도 → TTL 만료

---

# ═══════════════════════════════════════════════════════
# PART 7: 기존 데이터와의 관계
# ═══════════════════════════════════════════════════════

relationship_with_existing_data:
  
  기존_Canonical_청크:
    
    비즈니스_모델_패턴:
      chunk_id: "CAN-subscription-001"
      chunk_type: "business_model_pattern"
      
      기존_용도:
        - Explorer: 패턴 매칭
        - Quantifier: 계산 방법 참조
      
      Guestimation_활용:
        
        옵션_1_필드_추가:
          estimation_data:
            metrics:
              churn_rate: {value: 0.06, range: [...]}
          
          효과:
            - 같은 청크에 추정 데이터 포함
            - 패턴 + 추정값 함께 관리
        
        옵션_2_별도_청크:
          새_청크_생성:
            chunk_id: "CAN-subscription-est-001"
            chunk_type: "pattern_estimation_data"
            
            related_pattern: "CAN-subscription-001"
          
          효과:
            - 패턴과 분리
            - 독립 관리
        
        권장: 옵션_1 (필드 추가)
          이유:
            - 패턴과 추정값은 연관됨
            - 함께 관리가 자연스러움
            - 중복 없음
    
    학습된_규칙:
      chunk_id: "CAN-learned-food-001"
      chunk_type: "learned_estimation_rule" ⭐
      
      용도:
        - Guestimation만 사용
        - 다른 Agent는 관심 없음
      
      sections:
        - agent_view: "guestimation" (단일!)
      
      특징:
        - Guestimation 전용 청크
        - 다른 Agent sections 없음
  
  Projection_Views:
    
    기존_Views:
      - explorer (354개 청크)
      - quantifier (100개 청크)
      - validator (84개 청크)
      - observer (80개 청크)
    
    Guestimation_View_추가:
      - guestimation (0 → 2,000개 청크) ⭐
      
      출처:
        1. 기존 패턴의 estimation_data 섹션
           → "CAN-subscription-001" (business_model)
              → "PRJ-subscription-gst-001" (guestimation view)
        
        2. 학습된 규칙
           → "CAN-learned-food-001" (learned_rule)
              → "PRJ-learned-food-gst-001" (guestimation view)
        
        3. 사용자 기여
           → "CAN-user-saas-001" (learned_rule)
              → "PRJ-user-saas-gst-001" (guestimation view)

---

# ═══════════════════════════════════════════════════════
# PART 8: 구현 가이드
# ═══════════════════════════════════════════════════════

implementation_guide:
  
  Phase_1_스키마_확장:
    
    파일: "config/schema_registry.yaml"
    
    작업:
      1. chunk_type_추가:
         allowed_chunk_types:
           - business_model_pattern
           - success_case
           - learned_estimation_rule ⭐
      
      2. agent_view_추가:
         allowed_agent_views:
           - explorer
           - quantifier
           - validator
           - observer
           - guardian
           - guestimation ⭐
      
      3. guestimation_필드_정의:
         guestimation_metadata:
           question_pattern: {type: "object", required: true}
           estimation_context: {type: "object", required: true}
           estimation_result: {type: "object", required: true}
           provenance: {type: "object", required: true}
    
    예상_시간: "1-2시간"
  
  Phase_2_Projection_Rules:
    
    파일: "config/projection_rules.yaml"
    
    작업:
      1. estimation_data_규칙:
         field_rules:
           estimation_data:
             agents: [guestimation]
             projection_method: "extract_and_flatten"
      
      2. 변환_로직_추가:
         - 중첩 구조 → 평탄화
         - 검색 최적화
    
    예상_시간: "2-3시간"
  
  Phase_3_학습_로직:
    
    파일: "umis_rag/guestimation/learner.py" (신규)
    
    작업:
      1. Tier_2_결과_→_Canonical:
         - 메타데이터 생성
         - Canonical 문서 생성
         - canonical_index 추가
      
      2. Projected_자동_생성:
         - Projection Rules 적용
         - projected_index 추가 (agent_view="guestimation")
      
      3. 재사용_감지:
         - usage_count 추적
         - 10회+ → 학습
    
    예상_시간: "1-2일"
  
  Phase_4_검색_인터페이스:
    
    파일: "umis_rag/guestimation/searcher.py" (신규)
    
    작업:
      1. search_learned_rule():
         - projected_index 검색
         - filter: {agent_view: "guestimation"}
         - 맥락 필터링
      
      2. Tier_1_통합:
         - Built-in 규칙 + Projected 검색
         - 통합 인터페이스
    
    예상_시간: "1일"

---

# ═══════════════════════════════════════════════════════
# PART 9: 장점 및 효과
# ═══════════════════════════════════════════════════════

benefits:
  
  아키텍처_일관성:
    
    Before:
      Collections:
        - canonical_index (패턴/사례)
        - projected_index (Agent 뷰)
        - tier1_learned_rules (별도!) ❌
      
      문제:
        - 2가지 아키텍처 혼재
        - 관리 분산
    
    After:
      Collections:
        - canonical_index (패턴/사례 + 학습된 규칙) ✅
        - projected_index (Agent 뷰 + guestimation 뷰) ✅
      
      효과:
        - 1가지 아키텍처로 통일
        - 통합 관리
  
  중복_제거:
    
    Before:
      데이터_A: canonical_index에 패턴
      데이터_B: tier1_learned_rules에 학습 규칙
      
      중복_가능성:
        - 패턴에 estimation_data 있음
        - 학습 규칙에도 같은 데이터
        - 동기화 문제
    
    After:
      데이터: canonical_index만
      
      View:
        - projected_index (guestimation)
        - 필요한 것만 투영
      
      중복: 없음!
  
  Projection_메커니즘_재사용:
    
    기존_메커니즘:
      - 90% 규칙 + 10% LLM
      - 자동 학습 (LLM → 규칙)
      - TTL 관리
    
    Guestimation_활용:
      - 동일한 메커니즘 그대로
      - 추가 개발 불필요
      - 검증된 시스템 사용
  
  통합_검색:
    
    한_번의_검색:
      query = "SaaS Churn은?"
      
      검색_대상:
        1. 패턴의 estimation_data
        2. 학습된 규칙
        3. 사용자 기여
        
        모두 projected_index (agent_view="guestimation")에!
    
    효율성:
      - 검색 1번
      - 필터링 1번
      - 병합 불필요

---

# ═══════════════════════════════════════════════════════
# PART 10: 최종 설계 결정
# ═══════════════════════════════════════════════════════

final_decision:
  
  선택: "Canonical-Projected 통합" ✅
  
  이유:
    1. 아키텍처_일관성 (가장 중요!)
       - UMIS RAG 철학 준수
       - Canonical = Single Source of Truth
       - Projected = Materialized Views
    
    2. 중복_제거
       - 1곳에만 저장 (Canonical)
       - 여러 뷰로 검색 (Projected)
    
    3. 메커니즘_재사용
       - Projection Rules 90% + LLM 10%
       - 자동 학습
       - TTL 관리
    
    4. 확장성
       - 새 Agent View 추가 쉬움
       - 기존 패턴에 필드만 추가
  
  구현_복잡도:
    
    예상:
      - 스키마 확장: 2-3시간
      - Projection Rules: 2-3시간
      - 학습 로직: 1-2일
      - 검색 로직: 1일
      
      총: 3-4일
    
    vs_별도_Collection: 2-3일
    
    차이: +1일
    
    트레이드오프:
      - 구현 +1일
      - 하지만 장기 유지보수 ↓↓
      - 아키텍처 일관성 ↑↑
      
      결론: +1일 투자 가치 충분!

---

# ═══════════════════════════════════════════════════════
# PART 11: 마이그레이션 계획
# ═══════════════════════════════════════════════════════

migration_plan:
  
  기존_데이터_처리:
    
    기존_패턴_사례:
      
      파일: "data/raw/umis_business_model_patterns.yaml"
      
      현재:
        subscription_model:
          trigger_observations: "..."
          success_cases: "..."
          # estimation_data 없음
      
      추가:
        subscription_model:
          # 기존 필드
          trigger_observations: "..."
          success_cases: "..."
          
          # 신규 필드 ⭐
          estimation_data:
            metrics:
              churn_rate:
                value: 0.06
                range: [0.05, 0.07]
                context: {...}
      
      방법:
        - YAML 파일 수작업 추가 or
        - 별도 YAML 파일 (estimation_benchmarks.yaml)
        - Canonical 빌드 시 병합
    
    학습_데이터:
      
      초기: 0개
      
      생성:
        - Tier 2/3 사용하며 자동 생성
        - Canonical에 추가
        - Projected 자동 생성
  
  호환성:
    
    기존_Agent:
      - Explorer, Quantifier 등
      - 영향 없음 (자신의 View만 사용)
      - guestimation 필드 무시
    
    Guestimation:
      - guestimation View만 사용
      - 다른 Agent 필드 무시

---

# ═══════════════════════════════════════════════════════
# END - Canonical-Projected 통합 설계
# ═══════════════════════════════════════════════════════

