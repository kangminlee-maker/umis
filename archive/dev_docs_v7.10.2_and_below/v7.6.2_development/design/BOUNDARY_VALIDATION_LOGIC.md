# LLM ê¸°ë°˜ Boundary ê²€ì¦ ì‹œìŠ¤í…œ êµ¬í˜„ ë¡œì§

**íŒŒì¼**: `boundary_validator.py`  
**ë²„ì „**: v7.6.2  
**ëª©ì **: ì¶”ì •ê°’ì˜ íƒ€ë‹¹ì„±ì„ ë¹„ì •í˜•ì  ì‚¬ê³ ë¡œ ê²€ì¦

---

## ğŸ—ï¸ ì „ì²´ êµ¬ì¡°

```
BoundaryValidator.validate(question, value, context)
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: Hard Boundaries             â”‚
â”‚ (ì ˆëŒ€ í•œê³„ - ìœ„ë°˜ ì‹œ ê±°ë¶€)          â”‚
â”‚  â”œâ”€ ìˆ˜í•™ì  í•œê³„                     â”‚
â”‚  â”œâ”€ ë¬¼ë¦¬ì  í•œê³„                     â”‚
â”‚  â””â”€ ë…¼ë¦¬ì  í•œê³„                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“ ìœ„ë°˜ ì—†ìŒ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: Soft Boundaries             â”‚
â”‚ (ì°¸ê³  ë²”ìœ„ - ê²½ê³ ë§Œ)                â”‚
â”‚  â”œâ”€ í†µê³„ì  ë²”ìœ„                     â”‚
â”‚  â”œâ”€ ì—…ê³„ ê´€í–‰                       â”‚
â”‚  â””â”€ ê²½í—˜ì  ìƒì‹                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“ ê²½ê³  ê¸°ë¡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: LLM Reasoning               â”‚
â”‚ (ë¹„ì •í˜• ì‚¬ê³ )                       â”‚
â”‚  â”œâ”€ Native: Cursor ì§ì ‘ íŒë‹¨        â”‚
â”‚  â””â”€ External: GPT API í˜¸ì¶œ          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
BoundaryCheck ë°˜í™˜
  - is_valid: bool
  - violations: []
  - warnings: []
  - confidence: 0.75-1.0
```

---

## ğŸ“‹ Step 1: Hard Boundaries (ì ˆëŒ€ í•œê³„)

### **ëª©ì **
ë¬¼ë¦¬ì , ë²•ì , ë…¼ë¦¬ì ìœ¼ë¡œ ë¶ˆê°€ëŠ¥í•œ ê°’ ê±°ë¶€

### **êµ¬í˜„**

```python
def _check_hard_boundaries(question, value, unit, context):
    violations = []
    
    # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    # 1. ìˆ˜í•™ì  í•œê³„
    # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    if 'ë¹„ìœ¨' in question or 'rate' in question:
        if value < 0 or value > 1:
            violations.append("ë¹„ìœ¨ ë²”ìœ„ ìœ„ë°˜: [0, 1]")
    
    if 'ë°±ë¶„ìœ¨' in question:
        if value < 0 or value > 100:
            violations.append("ë°±ë¶„ìœ¨ ë²”ìœ„ ìœ„ë°˜: [0, 100]")
    
    # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    # 2. ë¬¼ë¦¬ì  í•œê³„
    # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    if value < 0:
        violations.append("ìŒìˆ˜ ê°’ (ë¬¼ë¦¬ì  ë¶ˆê°€ëŠ¥)")
    
    # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    # 3. ë…¼ë¦¬ì  í•œê³„ (ìƒìœ„ > í•˜ìœ„)
    # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    if 'ìŒì‹ì ' in question and context.region == 'í•œêµ­':
        if value > 51_000_000:  # ì¸êµ¬ë³´ë‹¤ ë§ìŒ!
            violations.append("ìŒì‹ì  > ì¸êµ¬ (ë¹„ë…¼ë¦¬ì )")
    
    if 'ì„œìš¸ ì¸êµ¬' in question:
        if value > 51_000_000:  # í•œêµ­ ì¸êµ¬ë³´ë‹¤ ë§ìŒ!
            violations.append("ì„œìš¸ ì¸êµ¬ > í•œêµ­ ì¸êµ¬")
    
    return {
        'violations': violations,
        'reasoning': "; ".join(violations)
    }
```

### **ì˜ˆì‹œ**

```python
# Case 1: ìˆ˜í•™ì  í•œê³„
question = "ì´íƒˆë¥ ì€?"
value = 1.5  # 150%

â†’ violations: ["ë¹„ìœ¨ ë²”ìœ„ ìœ„ë°˜: [0, 1]"]
â†’ is_valid: False âŒ

# Case 2: ë…¼ë¦¬ì  í•œê³„
question = "í•œêµ­ ìŒì‹ì  ìˆ˜ëŠ”?"
value = 51_000_000  # ì¸êµ¬ì™€ ê°™ìŒ

â†’ violations: ["ìŒì‹ì  > ì¸êµ¬"]
â†’ is_valid: False âŒ

# Case 3: ì •ìƒ
question = "í•œêµ­ ìŒì‹ì  ìˆ˜ëŠ”?"
value = 680_000

â†’ violations: []
â†’ í†µê³¼ âœ…
```

---

## ğŸ“‹ Step 2: Soft Boundaries (ì°¸ê³  ë²”ìœ„)

### **ëª©ì **
ì¼ë°˜ì  ë²”ìœ„ë¥¼ ë²—ì–´ë‚œ ê²½ìš° ê²½ê³  (ê±°ë¶€ ì•„ë‹˜)

### **êµ¬í˜„**

```python
def _check_soft_boundaries(question, value, unit, context):
    warnings = []
    
    # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    # ê²½í—˜ì  ë²”ìœ„ (ìƒì‹ì„ )
    # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    # ìŒì‹ì  ìˆ˜ (í•œêµ­)
    if 'ìŒì‹ì ' in question and 'í•œêµ­' in question:
        if value < 100_000 or value > 2_000_000:
            warnings.append(
                f"ì¼ë°˜ ë²”ìœ„ ë²—ì–´ë‚¨: {value:,.0f}ê°œ "
                f"(ì¼ë°˜: 10ë§Œ-200ë§Œ)"
            )
    
    # ì‹œì¥ ê·œëª¨ (ë””ì§€í„¸)
    if 'ì‹œì¥' in question and 'digital' in context.domain:
        if value < 1000ì–µ or value > 10ì¡°:
            warnings.append(
                f"ë””ì§€í„¸ ì‹œì¥ ì¼ë°˜ ë²”ìœ„ ë²—ì–´ë‚¨: "
                f"{value:,.0f}ì› (ì¼ë°˜: 1000ì–µ-10ì¡°)"
            )
    
    return {
        'warnings': warnings,
        'min': 100_000,  # ì°¸ê³ ìš©
        'max': 2_000_000
    }
```

### **ì˜ˆì‹œ**

```python
# Case 1: ê²½ê³ 
question = "í•œêµ­ ìŒì‹ì  ìˆ˜ëŠ”?"
value = 50_000  # ë„ˆë¬´ ì ìŒ

â†’ warnings: ["ì¼ë°˜ ë²”ìœ„ ë²—ì–´ë‚¨ (10ë§Œ-200ë§Œ)"]
â†’ is_valid: True (ê²½ê³ ë§Œ)
â†’ confidence: 0.75 (ì¡°ì •)

# Case 2: ì •ìƒ
value = 680_000  # ë²”ìœ„ ë‚´

â†’ warnings: []
â†’ is_valid: True
â†’ confidence: 0.90
```

---

## ğŸ“‹ Step 3: LLM Reasoning (ë¹„ì •í˜• ì‚¬ê³ )

### **ëª©ì **
ê·œì¹™ìœ¼ë¡œ ëª» ì¡ëŠ” ë¯¸ë¬˜í•œ ë¬¸ì œë¥¼ LLMì´ íŒë‹¨

### **3-1. Native Mode (Cursor ì§ì ‘ íŒë‹¨)**

```python
def _native_boundary_check(question, value, unit, context):
    """Cursorê°€ ì§ì ‘ íŒë‹¨í•˜ëŠ” í…œí”Œë¦¿"""
    
    violations = []
    warnings = []
    
    # ë‹´ë°°ê°‘ íŒë§¤ëŸ‰
    if 'ë‹´ë°°' in question:
        # ì´ë¡ ì  ìµœëŒ€ ê³„ì‚°
        max_smokers = 10_000_000
        max_packs_per_day = 2.0  # ë§¤ìš° ë¬´ê±°ìš´ í¡ì—°ì
        theoretical_max = max_smokers * max_packs_per_day
        
        if value > theoretical_max:
            violations.append(
                f"ì´ë¡ ì  ìµœëŒ€ {theoretical_max:,.0f}ê°‘ ì´ˆê³¼"
            )
    
    # ìŒì‹ì  ìˆ˜
    if 'ìŒì‹ì ' in question:
        # ìƒí•œ: ì¸êµ¬ / 10 (ê·¹ë‹¨ì  ë°€ì§‘)
        max_possible = 51_000_000 / 10
        
        if value > max_possible:
            violations.append(
                f"ê·¹ë‹¨ì  ë°€ì§‘ë„ ì´ˆê³¼ (ìµœëŒ€ {max_possible:,.0f}ê°œ)"
            )
        
        # í•˜í•œ: ì¸êµ¬ / 1000 (ë§¤ìš° í¬ë°•)
        min_possible = 51_000_000 / 1000
        
        if value < min_possible:
            warnings.append(
                f"ë§¤ìš° í¬ë°• (ìµœì†Œ {min_possible:,.0f}ê°œ)"
            )
    
    return {
        'violations': violations,
        'warnings': warnings
    }
```

**íŠ¹ì§•**:
- ë¹ ë¦„ (<0.1ì´ˆ)
- ë¹„ìš©: $0
- ì»¤ë²„ë¦¬ì§€: ì£¼ìš” ì¼€ì´ìŠ¤ 70-80%

---

### **3-2. External Mode (GPT API í˜¸ì¶œ)**

```python
def _external_boundary_check(question, value, unit, context, formula):
    """GPT APIë¡œ ì •êµí•œ ê²€ì¦"""
    
    # í”„ë¡¬í”„íŠ¸ êµ¬ì„±
    prompt = f"""
    ì§ˆë¬¸: {question}
    ì¶”ì •ê°’: {value:,.0f} {unit}
    ê³µì‹: {formula}
    
    ê²€ì¦:
    1. Hard Boundaries (ì ˆëŒ€ í•œê³„)
    2. Soft Boundaries (ì°¸ê³  ë²”ìœ„)
    3. ìƒìœ„/í•˜ìœ„ ê°œë…
    
    YAML í˜•ì‹ìœ¼ë¡œ ì¶œë ¥:
    ```yaml
    hard_violations: []
    soft_warnings: []
    recommended_range: [min, max]
    reasoning: "íŒë‹¨ ê·¼ê±°"
    ```
    """
    
    # GPT API í˜¸ì¶œ
    response = openai_client.chat.completions.create(
        model="gpt-4",
        temperature=0.1,  # ê°ê´€ì  íŒë‹¨
        messages=[
            {"role": "system", "content": "íƒ€ë‹¹ì„± ê²€ì¦ ì „ë¬¸ê°€"},
            {"role": "user", "content": prompt}
        ]
    )
    
    # ì‘ë‹µ íŒŒì‹±
    yaml_output = parse_yaml(response.content)
    
    return {
        'violations': yaml_output['hard_violations'],
        'warnings': yaml_output['soft_warnings'],
        'reasoning': yaml_output['reasoning']
    }
```

**íŠ¹ì§•**:
- ì •êµí•¨ (ë¹„ì •í˜• ì¼€ì´ìŠ¤ ì²˜ë¦¬)
- ë¹„ìš©: ~$0.001 per call
- ì»¤ë²„ë¦¬ì§€: 95%+

---

## ğŸ”„ í†µí•© í”„ë¡œì„¸ìŠ¤

### **Tier 3ì—ì„œ í˜¸ì¶œ**

```python
# tier3.py - _phase4_execute()

# Step 1: ëª¨í˜• ì‹¤í–‰
result = self._execute_formula(model)
# â†’ ìŒì‹ì  ìˆ˜: 51,000,000ê°œ

# Step 2: Boundary ê²€ì¦ â­
boundary_check = self._phase5_boundary_validation(
    result, question, model, depth
)

if not boundary_check.is_valid:
    # Hard Boundary ìœ„ë°˜!
    logger.warning(f"âŒ {boundary_check.hard_violations}")
    return None  # ê±°ë¶€!

# Step 3: Soft warning ì²˜ë¦¬
if boundary_check.soft_warnings:
    # confidence ì¡°ì •
    original_conf = result.confidence
    result.confidence *= boundary_check.confidence
    logger.info(f"âš ï¸  confidence {original_conf} â†’ {result.confidence}")

# Step 4: ë°˜í™˜
return result
```

---

## ğŸ¯ ì‹¤ì œ ë™ì‘ ì˜ˆì‹œ

### **ì˜ˆì‹œ 1: Hard Boundary ìœ„ë°˜ (ê±°ë¶€)**

```
ì§ˆë¬¸: "í•œêµ­ ìŒì‹ì  ìˆ˜ëŠ”?"
ì¶”ì •: 51,000,000ê°œ (Tier 3 Native, ì¬ê·€ ì‹¤íŒ¨ë¡œ ì¸êµ¬ê°’ ê·¸ëŒ€ë¡œ)

Boundary ê²€ì¦:
  â†“
Hard Boundary Check:
  - ìŒì‹ì  51,000,000ê°œ > í•œêµ­ ì¸êµ¬ 51,000,000ëª…
  - violations: ["ìŒì‹ì  > ì¸êµ¬ (ë¹„ë…¼ë¦¬ì )"]
  â†“
is_valid: False âŒ

ê²°ê³¼: ê±°ë¶€, None ë°˜í™˜
  â†’ ë‹¤ìŒ ëª¨í˜• ì‹œë„ ë˜ëŠ” ì‹¤íŒ¨ ì²˜ë¦¬
```

**íš¨ê³¼**: ë¹„í˜„ì‹¤ì  ê°’ ë°˜í™˜ ë°©ì§€!

---

### **ì˜ˆì‹œ 2: Soft Boundary ê²½ê³  (í†µê³¼, confidence ì¡°ì •)**

```
ì§ˆë¬¸: "í•œêµ­ ìŒì‹ì  ìˆ˜ëŠ”?"
ì¶”ì •: 510,000ê°œ (Tier 3 Fallback)

Boundary ê²€ì¦:
  â†“
Hard Boundary Check:
  - violations: [] (í†µê³¼)
  â†“
Soft Boundary Check:
  - ë²”ìœ„: [100,000 ~ 2,000,000]
  - 510,000 â†’ ë²”ìœ„ ë‚´
  - warnings: [] (í†µê³¼)
  â†“
is_valid: True âœ…
confidence: 0.90

ê²°ê³¼: í†µê³¼, confidence ê·¸ëŒ€ë¡œ
```

---

### **ì˜ˆì‹œ 3: LLM Reasoning (ê³ ê¸‰)**

```
ì§ˆë¬¸: "ê°•ë‚¨ ìŠ¤íƒ€íŠ¸ì—… í‰ê·  ì§ì› ìˆ˜ëŠ”?"
ì¶”ì •: 5,000ëª…

Native Boundary Check:
  - ì¼ë°˜ ê·œì¹™ì— ì—†ìŒ â†’ í†µê³¼
  
LLM Boundary Check (External Mode):
  â†“
GPT-4 í”„ë¡¬í”„íŠ¸:
  "ê°•ë‚¨ ìŠ¤íƒ€íŠ¸ì—… í‰ê·  ì§ì› 5,000ëª…ì´ íƒ€ë‹¹í•œê°€?
   
   ê²€ì¦:
   1. ê°•ë‚¨ ìŠ¤íƒ€íŠ¸ì—… ì´ ê°œìˆ˜ ì¶”ì •
   2. ì „ì²´ IT ì¸ë ¥ ì¶”ì •
   3. ìƒìœ„/í•˜ìœ„ ê°œë… ì²´í¬"
  
GPT-4 ì‘ë‹µ:
```yaml
hard_violations:
  - "í‰ê·  5,000ëª…ì€ ë¹„í˜„ì‹¤ì "
  - "ê°•ë‚¨ ìŠ¤íƒ€íŠ¸ì—… ëŒ€ë¶€ë¶„ 50ëª… ì´í•˜"
  - "5,000ëª…ì€ ëŒ€ê¸°ì—… ê·œëª¨"
soft_warnings: []
reasoning: "í‰ê·  ì§ì› ìˆ˜ëŠ” ë³´í†µ 10-100ëª… ë²”ìœ„"
recommended_range: [10, 100]
```

ê²°ê³¼: is_valid: False âŒ
  â†’ ê±°ë¶€, ë‹¤ìŒ ëª¨í˜• ì‹œë„
```

---

## ğŸ¯ Hard vs Soft Boundary êµ¬ë¶„

### **Hard Boundary (ì ˆëŒ€ í•œê³„)**

```
íŠ¹ì§•:
  - ìœ„ë°˜ ì‹œ ë¬´ì¡°ê±´ ê±°ë¶€
  - is_valid = False
  - ë¬¼ë¦¬/ë²•ë¥ /ë…¼ë¦¬ì ìœ¼ë¡œ ë¶ˆê°€ëŠ¥

ì˜ˆì‹œ:
  âœ… í™•ë¥  [-0.1] â†’ ê±°ë¶€ (ìˆ˜í•™ì  í•œê³„)
  âœ… ìŒì‹ì  100Mê°œ â†’ ê±°ë¶€ (ì¸êµ¬ < ìŒì‹ì )
  âœ… ì‹œê¸‰ 5,000ì› â†’ ê±°ë¶€ (ìµœì €ì„ê¸ˆ ìœ„ë°˜)
  âœ… ê·¼ë¡œì‹œê°„ 80ì‹œê°„/ì£¼ â†’ ê±°ë¶€ (ë²•ì • 52ì‹œê°„)
```

### **Soft Boundary (ì°¸ê³  ë²”ìœ„)**

```
íŠ¹ì§•:
  - ê²½ê³ ë§Œ, í†µê³¼ëŠ” ì‹œí‚´
  - is_valid = True
  - confidence ì¡°ì • (0.90 â†’ 0.75)

ì˜ˆì‹œ:
  âš ï¸  ìŒì‹ì  50,000ê°œ (ë²”ìœ„: 10ë§Œ-200ë§Œ, ì ìŒ)
     â†’ ê²½ê³ , confidence 0.75
  
  âš ï¸  ë””ì§€í„¸ ì‹œì¥ 500ì–µ (ë²”ìœ„: 1000ì–µ-10ì¡°, ì‘ìŒ)
     â†’ ê²½ê³ , confidence 0.75
```

---

## ğŸ’¡ ë¹„ì •í˜• ì‚¬ê³  ì˜ˆì‹œ

### **ìƒìœ„/í•˜ìœ„ ê°œë… í™œìš©**

```
ê°œë… ê³„ì¸µ:
  í•œêµ­ ì „ì²´
    â”œâ”€ ì„œìš¸
    â”‚   â”œâ”€ ê°•ë‚¨êµ¬
    â”‚   â””â”€ ê°•ë¶êµ¬
    â””â”€ ë¶€ì‚°

ë…¼ë¦¬ì  í•œê³„:
  ê°•ë‚¨ ì¸êµ¬ < ì„œìš¸ ì¸êµ¬ < í•œêµ­ ì¸êµ¬
  
ê²€ì¦:
  "ê°•ë‚¨ ì¸êµ¬ 20M" â†’ ì„œìš¸ 10Më³´ë‹¤ í¼ â†’ ê±°ë¶€! âŒ
  "ì„œìš¸ ì¸êµ¬ 8M" â†’ í•œêµ­ 51Më³´ë‹¤ ì‘ìŒ â†’ í†µê³¼ âœ…
```

### **ë¬¼ë¦¬ì  í•œê³„ í™œìš©**

```
ë‹´ë°° íŒë§¤ëŸ‰:
  
ìƒí•œ ê³„ì‚°:
  ìµœëŒ€ í¡ì—°ì: 10,000,000ëª… (ë§¤ìš° ë†’ê²Œ)
  ìµœëŒ€ í¡ì—°ëŸ‰: 2.0ê°‘/ì¼ (ë§¤ìš° ë¬´ê±°ìš´ í¡ì—°ì)
  ì´ë¡ ì  ìµœëŒ€: 20,000,000ê°‘/ì¼
  
ê²€ì¦:
  ì¶”ì • 87,671,233ê°‘ > 20,000,000ê°‘
  â†’ ë¹„í˜„ì‹¤ì ! âŒ
  
  ì¶”ì • 5,310,500ê°‘ < 20,000,000ê°‘
  â†’ ê°€ëŠ¥ âœ…
```

### **ë²•ì  í•œê³„ í™œìš©**

```
ìµœì €ì„ê¸ˆ:
  ë²•ì •: 9,860ì›/ì‹œê°„ (2024)
  
ê²€ì¦:
  "í‰ê·  ì‹œê¸‰ 5,000ì›" â†’ ë²•ì • ë¯¸ë‹¬ â†’ ê±°ë¶€! âŒ
  "í‰ê·  ì‹œê¸‰ 15,000ì›" â†’ ë²•ì • ì´ìƒ â†’ í†µê³¼ âœ…

ê·¼ë¡œì‹œê°„:
  ë²•ì • ìµœëŒ€: 52ì‹œê°„/ì£¼
  
ê²€ì¦:
  "í‰ê·  ê·¼ë¡œì‹œê°„ 80ì‹œê°„/ì£¼" â†’ ë²•ë¥  ìœ„ë°˜ â†’ ê±°ë¶€! âŒ
  "í‰ê·  ê·¼ë¡œì‹œê°„ 45ì‹œê°„/ì£¼" â†’ í•©ë²• â†’ í†µê³¼ âœ…
```

---

## ğŸ”§ LLM í”„ë¡¬í”„íŠ¸ ì„¤ê³„

### **External Mode í”„ë¡¬í”„íŠ¸**

```
ì¶”ì •ê°’ì˜ íƒ€ë‹¹ì„±ì„ ê²€ì¦í•˜ì„¸ìš”.

ì§ˆë¬¸: {question}
ì¶”ì •ê°’: {value:,.0f} {unit}
ë„ë©”ì¸: {context.domain}
ì§€ì—­: {context.region}
ì‚¬ìš© ê³µì‹: {formula}

ê²€ì¦ í•­ëª©:

1. Hard Boundaries (ì ˆëŒ€ í•œê³„):
   - ë¬¼ë¦¬ì  í•œê³„ (ë¶ˆê°€ëŠ¥í•œ ê°’)
     ì˜ˆ: ì†ë„ > ê´‘ì†, í™•ë¥  > 1
   
   - ë²•ì  í•œê³„ (ë²•ë¥  ìœ„ë°˜)
     ì˜ˆ: ì‹œê¸‰ < ìµœì €ì„ê¸ˆ, ê·¼ë¡œì‹œê°„ > 52ì‹œê°„
   
   - ë…¼ë¦¬ì  í•œê³„ (ë¶€ë¶„ > ì „ì²´)
     ì˜ˆ: ì„œìš¸ ì¸êµ¬ > í•œêµ­ ì¸êµ¬
     ì˜ˆ: ìŒì‹ì  ìˆ˜ > ì¸êµ¬ ìˆ˜

2. Soft Boundaries (ì°¸ê³  ë²”ìœ„):
   - í†µê³„ì  ë²”ìœ„ (p10-p90)
   - ì—…ê³„ ì¼ë°˜ ë²”ìœ„
   - ê²½í—˜ì  ìƒì‹

3. ìƒìœ„/í•˜ìœ„ ê°œë…:
   - ë¶€ë¶„ < ì „ì²´ í™•ì¸
   - ì„¸ë¶€ < ì´í•© í™•ì¸
   - ì§€ì—­ < êµ­ê°€ í™•ì¸

ì¶œë ¥ í˜•ì‹ (YAML):
```yaml
hard_violations: []  # ì ˆëŒ€ í•œê³„ ìœ„ë°˜ (ìˆìœ¼ë©´ ë¦¬ìŠ¤íŠ¸)
soft_warnings: []    # ì°¸ê³  ë²”ìœ„ ì´íƒˆ (ìˆìœ¼ë©´ ë¦¬ìŠ¤íŠ¸)
recommended_range: [min, max]  # ê¶Œì¥ ë²”ìœ„
reasoning: "íŒë‹¨ ê·¼ê±° (êµ¬ì²´ì ìœ¼ë¡œ)"
```

ë¹„í˜„ì‹¤ì ì´ë©´ violationsì— ì´ìœ ë¥¼ ëª…ì‹œí•˜ì„¸ìš”.
íƒ€ë‹¹í•˜ë©´ ë¹ˆ ë¦¬ìŠ¤íŠ¸ë¥¼ ë°˜í™˜í•˜ì„¸ìš”.
```

### **LLM ì‘ë‹µ ì˜ˆì‹œ**

```yaml
# íƒ€ë‹¹í•œ ê²½ìš°
hard_violations: []
soft_warnings: []
recommended_range: [500000, 800000]
reasoning: "í•œêµ­ ìŒì‹ì  680,000ê°œëŠ” íƒ€ë‹¹í•¨. ì¸êµ¬ 51M ëŒ€ë¹„ 75ëª…/ì ìœ¼ë¡œ ì¼ë°˜ì  ë°€ë„."

# ë¹„íƒ€ë‹¹í•œ ê²½ìš°
hard_violations:
  - "ìŒì‹ì  51,000,000ê°œëŠ” ì¸êµ¬(51,000,000ëª…)ë³´ë‹¤ ë§ìŒ"
  - "1ì¸ë‹¹ 1ê°œ ìŒì‹ì ì€ ë¹„í˜„ì‹¤ì "
soft_warnings: []
reasoning: "ë…¼ë¦¬ì ìœ¼ë¡œ ë¶ˆê°€ëŠ¥. ìµœëŒ€ ë°€ë„(10ëª…/ì )ë¡œ ê³„ì‚°í•´ë„ 5,100,000ê°œê°€ ìƒí•œ."
```

---

## ğŸ“Š ì²˜ë¦¬ íë¦„ ìƒì„¸

```
Tier 3 ì¶”ì • ì™„ë£Œ
  â†“
Phase 5: Boundary ê²€ì¦
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Hard Boundary Check                 â”‚
â”‚                                     â”‚
â”‚ if value < 0:                       â”‚
â”‚   violations.append("ìŒìˆ˜")         â”‚
â”‚                                     â”‚
â”‚ if ìŒì‹ì  > ì¸êµ¬:                   â”‚
â”‚   violations.append("ë¹„ë…¼ë¦¬ì ")     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
  violations ìˆìŒ?
  â†“ Yes
  âŒ ê±°ë¶€, None ë°˜í™˜
  
  â†“ No
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Soft Boundary Check                 â”‚
â”‚                                     â”‚
â”‚ if value < 100K or > 2M:            â”‚
â”‚   warnings.append("ë²”ìœ„ ë²—ì–´ë‚¨")    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LLM Reasoning                       â”‚
â”‚                                     â”‚
â”‚ Native Mode:                        â”‚
â”‚   - í…œí”Œë¦¿ ê·œì¹™ ì ìš©                â”‚
â”‚   - Cursor ì§ì ‘ íŒë‹¨                â”‚
â”‚                                     â”‚
â”‚ External Mode:                      â”‚
â”‚   - GPT API í˜¸ì¶œ                    â”‚
â”‚   - ë¹„ì •í˜• ì‚¬ê³                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
BoundaryCheck ìƒì„±
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Confidence ì¡°ì •                     â”‚
â”‚                                     â”‚
â”‚ if soft_warnings:                   â”‚
â”‚   confidence *= 0.75                â”‚
â”‚ else:                               â”‚
â”‚   confidence = 0.90                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
âœ… ë°˜í™˜
```

---

## ğŸ¯ í™•ì¥ ê°€ëŠ¥ì„±

### **ë„ë©”ì¸ë³„ ê·œì¹™ ì¶”ê°€**

```python
# SaaS ë„ë©”ì¸
if context.domain == "B2B_SaaS":
    if 'churn' in question:
        # B2B SaaS Churn: 2-12% (ì¼ë°˜)
        if value < 0.01 or value > 0.20:
            warnings.append("SaaS Churn ì¼ë°˜ ë²”ìœ„ ë²—ì–´ë‚¨")

# ë¶€ë™ì‚° ë„ë©”ì¸
if context.domain == "Real_Estate":
    if 'ê°€ê²©' in question and 'ì•„íŒŒíŠ¸' in question:
        if value < 1ì–µ or value > 50ì–µ:
            warnings.append("ì•„íŒŒíŠ¸ ê°€ê²© ì¼ë°˜ ë²”ìœ„ ë²—ì–´ë‚¨")
```

### **ì‹œê³„ì—´ ë¹„êµ**

```python
# ì„±ì¥ë¥  ê²€ì¦
if 'growth' in question or 'ì„±ì¥' in question:
    # ì¼ë°˜ì  ì„±ì¥ë¥ : -20% ~ 200%
    if value < -0.20 or value > 2.0:
        warnings.append("ì„±ì¥ë¥  ë¹„ì •ìƒ (ì¼ë°˜: -20%~200%)")
```

---

## ğŸ’¡ í•µì‹¬ ì„¤ê³„ ì›ì¹™

### **1. ë¹„ì •í˜• ì‚¬ê³  í™œìš©**

```
ì •í˜• ê·œì¹™ìœ¼ë¡œëŠ” í•œê³„:
  - ëª¨ë“  ì¼€ì´ìŠ¤ ì»¤ë²„ ë¶ˆê°€ëŠ¥
  - ìƒˆë¡œìš´ ë„ë©”ì¸ ëŒ€ì‘ ì–´ë ¤ì›€

LLM í™œìš©:
  âœ… ë¹„ì •í˜• ì¼€ì´ìŠ¤ ì²˜ë¦¬
  âœ… ìƒìœ„/í•˜ìœ„ ê°œë… ì¶”ë¡ 
  âœ… ë§¥ë½ ê¸°ë°˜ íŒë‹¨
```

### **2. Hard/Soft êµ¬ë¶„**

```
Hard: ì ˆëŒ€ ë¶ˆê°€ëŠ¥ â†’ ê±°ë¶€
  - ë¹„ìœ¨ > 1
  - ìŒì‹ì  > ì¸êµ¬
  - ë²•ë¥  ìœ„ë°˜

Soft: ì´ìƒí•˜ì§€ë§Œ ê°€ëŠ¥ â†’ ê²½ê³  + confidence ì¡°ì •
  - ìŒì‹ì  50K (ì ì§€ë§Œ ê°€ëŠ¥)
  - ì‹œì¥ 50ì–µ (ì‘ì§€ë§Œ ê°€ëŠ¥)
```

### **3. Native ìš°ì„ , External ì„ íƒ**

```
Native Mode (ê¸°ë³¸):
  - í…œí”Œë¦¿ ê·œì¹™ (70-80% ì»¤ë²„)
  - ë¹„ìš©: $0
  - ì†ë„: ë¹ ë¦„

External Mode (í•„ìš” ì‹œ):
  - GPT API (95% ì»¤ë²„)
  - ë¹„ìš©: $0.001
  - ì •êµí•¨
```

---

## ğŸ“Š ì˜ˆìƒ íš¨ê³¼

### **Boundary ê²€ì¦ ì „**

```
ìŒì‹ì  ìˆ˜ ì¶”ì •: 51,000,000ê°œ
  â†’ ë¹„í˜„ì‹¤ì ì´ì§€ë§Œ ê·¸ëŒ€ë¡œ ë°˜í™˜ âŒ
  â†’ ì‚¬ìš©ì í˜¼ë€
```

### **Boundary ê²€ì¦ í›„**

```
ìŒì‹ì  ìˆ˜ ì¶”ì •: 51,000,000ê°œ
  â†“
Boundary Check: ìŒì‹ì  > ì¸êµ¬
  â†“
âŒ ê±°ë¶€, None ë°˜í™˜
  â†“
ë‹¤ìŒ ëª¨í˜• ì‹œë„ ë˜ëŠ” Fallback
  â†“
510,000ê°œ (í•©ë¦¬ì ) âœ…
```

**ê°œì„ **: ë¹„í˜„ì‹¤ì  ê°’ ì œê±°, í’ˆì§ˆ í–¥ìƒ!

---

## ğŸ¯ ê²°ë¡ 

**LLM ê¸°ë°˜ Boundary ê²€ì¦**:

**êµ¬ì¡°**:
1. Hard Boundaries (ì ˆëŒ€ í•œê³„) â†’ ìœ„ë°˜ ì‹œ ê±°ë¶€
2. Soft Boundaries (ì°¸ê³  ë²”ìœ„) â†’ ê²½ê³  + confidence ì¡°ì •
3. LLM Reasoning (ë¹„ì •í˜•) â†’ Native/External

**íš¨ê³¼**:
- âœ… ë¹„í˜„ì‹¤ì  ê°’ ë°©ì§€
- âœ… Confidence ì¡°ì • (0.75-0.90)
- âœ… ì¶”ì • í’ˆì§ˆ í–¥ìƒ

**íŠ¹ì§•**:
- Native Mode ìš°ì„  (ë¹„ìš© $0, 70-80% ì»¤ë²„)
- External ì„ íƒ (ë¹„ìš© $0.001, 95% ì»¤ë²„)
- ë¹„ì •í˜• ì‚¬ê³ ë¡œ ê·œì¹™ í•œê³„ ê·¹ë³µ

ì´ê²ƒì´ Tier 3 ì •í™•ë„ë¥¼ 70% â†’ 75%ë¡œ ê°œì„ í•œ í•µì‹¬ ë¡œì§ì…ë‹ˆë‹¤! ğŸ¯
