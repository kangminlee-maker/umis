# ========================================
# umis.yaml â†’ System RAG ë³€í™˜ ê·œì¹™
# ========================================

version: 1.0
created: '2025-11-12'
purpose: umis.yamlì„ System RAGë¡œ ìë™ ë³€í™˜í•˜ëŠ” ê·œì¹™ ì •ì˜

# ========================================
# ë³€í™˜ ê·œì¹™
# ========================================

conversion_rules:
  
  # System ì„¹ì…˜ ì²˜ë¦¬
  system_sections:
    description: "umis.yaml ìµœìƒìœ„ ì„¹ì…˜ì„ tool:system:* ë„êµ¬ë¡œ ë³€í™˜"
    
    prefix: "system:"
    category: "complete_context"
    priority: "high"
    
    sections:
      - system_architecture
      - system
      - adaptive_intelligence_system
      - proactive_monitoring
      - support_validation_system
      - data_integrity_system
      - agents  # ì „ì²´ Agent ë¦¬ìŠ¤íŠ¸
      - roles
      - implementation_guide
    
    tool_key_format: "tool:system:{section_name}"
    tool_id_format: "system:{section_name}"
  
  # Agent ê°œë³„ ì²˜ë¦¬
  agent_sections:
    description: "agents ë¦¬ìŠ¤íŠ¸ì˜ ê° Agentë¥¼ tool:{agent}:complete ë„êµ¬ë¡œ ë³€í™˜"
    
    source: "agents list"
    id_field: "id"
    
    tool_key_format: "tool:{agent_id}:complete"
    tool_id_format: "{agent_id}:complete"
    
    category: "complete_context"
    priority: "high"
    
    agents:
      - Observer
      - Explorer
      - Quantifier
      - Validator
      - Guardian
      - Estimator
  
  # ì œì™¸ ì„¹ì…˜
  excluded_sections:
    description: "RAGì— í¬í•¨í•˜ì§€ ì•Šì„ ì„¹ì…˜ (ë©”íƒ€ë°ì´í„° ë“±)"
    
    sections:
      - _meta  # ë©”íƒ€ë°ì´í„°
      - version  # ë²„ì „ (registryì—ì„œ ê´€ë¦¬)
      - changelog  # ë³€ê²½ ì´ë ¥ (registryì—ì„œ ê´€ë¦¬)

# ========================================
# ê²€ì¦ ê·œì¹™
# ========================================

validation:
  
  required_sections:
    description: "umis.yamlì— ë°˜ë“œì‹œ ìˆì–´ì•¼ í•  ì„¹ì…˜"
    sections:
      - system_architecture
      - agents
      - implementation_guide
  
  required_agents:
    description: "agents ë¦¬ìŠ¤íŠ¸ì— ë°˜ë“œì‹œ ìˆì–´ì•¼ í•  Agent"
    agents:
      - Observer
      - Explorer
      - Quantifier
      - Validator
  
  tool_count:
    min: 10
    max: 100
    description: "ìƒì„±ë˜ëŠ” ë„êµ¬ ìˆ˜ ë²”ìœ„"
  
  tool_size:
    min: 100
    max: 100000  # 100KB
    description: "ê° ë„êµ¬ Content í¬ê¸° ë²”ìœ„ (bytes)"

# ========================================
# ë°±ì—… ê·œì¹™
# ========================================

backup:
  enabled: true
  directory: config/backups
  
  filename_format: "tool_registry_{timestamp}.yaml"
  timestamp_format: "%Y%m%d_%H%M%S"
  
  retention:
    days: 30
    max_files: 50
    description: "30ì¼ ë˜ëŠ” 50ê°œ ì´ˆê³¼ ì‹œ ì˜¤ë˜ëœ ë°±ì—… ì‚­ì œ"
  
  auto_cleanup: false  # ìë™ ì‚­ì œ (ì¶”í›„ êµ¬í˜„)

# ========================================
# RAG ì¬êµ¬ì¶• ì„¤ì •
# ========================================

rag_rebuild:
  script: scripts/build_system_knowledge.py
  collection: system_knowledge
  
  verify_after_build: true
  verification_script: scripts/query_system_rag.py
  verification_args: ['--stats']

# ========================================
# ì¶œë ¥ í˜•ì‹
# ========================================

output_format:
  
  tool_content_template: |
    # {section_type}: {section_name} (0% Loss from umis.yaml)
    
    ## ğŸ“‹ ì¶œì²˜
    umis.yaml - {section_name} ì„¹ì…˜ ì „ì²´ (Auto-Sync)
    
    ## ğŸ“– ì „ì²´ ë‚´ìš© (YAML)
    
    ì•„ë˜ëŠ” umis.yamlì˜ {section_name} ì„¹ì…˜ì„ 0% ì†ì‹¤ë¡œ ê·¸ëŒ€ë¡œ ë³µì‚¬í•œ ê²ƒì…ë‹ˆë‹¤.
    
    ```yaml
    {yaml_content}
    ```
    
    ---
    
    âš ï¸  ì´ ë„êµ¬ëŠ” ìë™ ìƒì„±ë©ë‹ˆë‹¤.
       ìˆ˜ì •í•˜ë ¤ë©´ umis.yamlì„ í¸ì§‘í•˜ê³  sync_umis_to_rag.pyë¥¼ ì‹¤í–‰í•˜ì„¸ìš”.
  
  registry_header: |
    # ========================================
    # âš ï¸  ì´ íŒŒì¼ì€ ìë™ ìƒì„±ë©ë‹ˆë‹¤!
    # 
    # í¸ì§‘ ê¸ˆì§€! ëŒ€ì‹  umis.yamlì„ ìˆ˜ì •í•˜ì„¸ìš”.
    # 
    # ë™ê¸°í™” ë°©ë²•:
    #   python3 scripts/sync_umis_to_rag.py
    # 
    # ë§ˆì§€ë§‰ ë™ê¸°í™”: {timestamp}
    # ========================================

# ========================================
# ì—ëŸ¬ ì²˜ë¦¬
# ========================================

error_handling:
  
  on_validation_fail:
    action: "rollback"
    message: "ê²€ì¦ ì‹¤íŒ¨. ì´ì „ ìƒíƒœë¡œ ë¡¤ë°±í•©ë‹ˆë‹¤."
  
  on_rag_build_fail:
    action: "rollback"
    message: "RAG êµ¬ì¶• ì‹¤íŒ¨. ì´ì „ ìƒíƒœë¡œ ë¡¤ë°±í•©ë‹ˆë‹¤."
  
  rollback_script: scripts/rollback_rag.py

# ========================================
# ë¬¸ì„œ ë
# ========================================





